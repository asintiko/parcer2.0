{"version":3,"file":"starsRangeInput-oVXm95vi.js","sources":["../src/components/sidebarLeft/tabs/privacy/messages/starsRangeInput.tsx"],"sourcesContent":["import {Component, createMemo} from 'solid-js';\r\n\r\nimport {numberThousandSplitterForStars} from '../../../../../helpers/number/numberThousandSplitter';\r\nimport accumulate from '../../../../../helpers/array/accumulate';\r\nimport clamp from '../../../../../helpers/number/clamp';\r\nimport nMap from '../../../../../helpers/number/nMap';\r\nimport {i18n} from '../../../../../lib/langPack';\r\n\r\nimport styles from './starsRangeInput.module.scss';\r\n\r\n\r\nconst starsPerUnits: [units: number, stars: number][] = [\r\n  [10, 1], // 1 star per unit until 10\r\n  [10, 2], // 2 stars per unit until 30\r\n  [14, 5], // 5 stars per unit until 100\r\n  [10, 10], // 10 stars per unit until 200\r\n  [12, 25], // 25 stars per unit until 500\r\n  [10, 50], // 50 stars per unit until 1.000\r\n  [15, 100], // 100 stars per unit until 2.500\r\n  [20, 250], // 250 stars per unit until 7.500\r\n  [5, 500] // 500 stars per unit until 10.000\r\n]; // 106 total units, try to be something close to 100\r\n\r\nconst totalUnits = accumulate(starsPerUnits.map(v => v[0]), 0);\r\nconst totalStars = unitsToStars(totalUnits);\r\n\r\nfunction unitsToStars(units: number) {\r\n  let stars = 0;\r\n\r\n  for(const [u, s] of starsPerUnits) {\r\n    stars += Math.min(units, u) * s;\r\n    units -= u;\r\n\r\n    if(units <= 0) break;\r\n  }\r\n\r\n  return stars;\r\n}\r\n\r\nfunction starsToUnits(stars: number) {\r\n  let units = 0;\r\n\r\n  for(const [u, s] of starsPerUnits) {\r\n    const v = Math.min(u, Math.floor(stars / s));\r\n\r\n    stars -= v * s;\r\n    units += v;\r\n  }\r\n\r\n  return units;\r\n}\r\n\r\nconst StarRangeInput: Component<{\r\n  value: number;\r\n  onChange: (value: number) => void;\r\n  startFromZero?: boolean;\r\n}> = (props) => {\r\n  const min = createMemo(() => props.startFromZero ? 0 : 1);\r\n\r\n  const units = () => clamp(starsToUnits(props.value), min(), totalUnits);\r\n\r\n  const normalizedValue = () => nMap(units(), min(), totalUnits, 0, 1);\r\n\r\n  const onInput = (e: InputEvent & { currentTarget: HTMLInputElement }) => {\r\n    const clampedValue = clamp(e.currentTarget.valueAsNumber, min(), totalUnits)\r\n    const newValue = Math.round(unitsToStars(clampedValue));\r\n\r\n    props.onChange(newValue);\r\n  }\r\n\r\n  return (\r\n    <div\r\n      class={styles.Container}\r\n      style={{\r\n        '--normalized': normalizedValue(),\r\n        '--w': normalizedValue() * 100 + '%'\r\n      }}\r\n    >\r\n      <div class={styles.Row}>\r\n        <div class={styles.Limit}>{min()}</div>\r\n        <div class={styles.Value}>{i18n('Stars', [\r\n          numberThousandSplitterForStars(parseInt(props.value.toFixed(0)))\r\n        ])}</div>\r\n        <div class={`${styles.Limit} ${styles.LimitLast}`}>{numberThousandSplitterForStars(totalStars)}</div>\r\n      </div>\r\n      <div class={styles.InputWrapper}>\r\n        <input\r\n          type=\"range\"\r\n          min={min()}\r\n          max={totalUnits}\r\n          step={1}\r\n          value={units()}\r\n          onInput={onInput}\r\n        />\r\n        <div class={styles.Background} />\r\n        <div class={styles.Thumb} />\r\n        <div class={styles.Progress} />\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default StarRangeInput;\r\n\r\n\r\n/*\r\n// Snippet to adjust stars per unit\r\n\r\nlet a = [\r\n  [10, 1],\r\n  [10, 2],\r\n  [14, 5],\r\n  [10, 10],\r\n  [12, 25],\r\n  [10, 50],\r\n  [15, 100],\r\n  [20, 250],\r\n  [5, 500]\r\n]\r\n\r\nlet c = 0;\r\nlet tu = 0;\r\nfor (const [u, s] of a) {\r\n  c += u * s;\r\n  tu += u;\r\n  console.log('tu, s, c', tu, s, c);\r\n}\r\n*/\r\n"],"names":["starsPerUnits","totalUnits","accumulate","map","v","totalStars","unitsToStars","units","stars","u","s","Math","min","starsToUnits","floor","StarRangeInput","props","createMemo","startFromZero","clamp","value","normalizedValue","nMap","onInput","e","clampedValue","currentTarget","valueAsNumber","newValue","round","onChange","_el$","_tmpl$","_el$2","firstChild","_el$3","_el$4","nextSibling","_el$5","_el$6","_el$7","_el$8","_el$9","_el$10","_$insert","i18n","numberThousandSplitterForStars","parseInt","toFixed","$$input","_$setAttribute","_$effect","_p$","_v$","styles","Container","_v$2","_v$3","_v$4","Row","_v$5","Limit","_v$6","Value","_v$7","LimitLast","_v$8","InputWrapper","_v$9","_v$10","Background","_v$11","Thumb","_v$12","Progress","_$className","style","setProperty","removeProperty","undefined","_$delegateEvents"],"mappings":"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"}