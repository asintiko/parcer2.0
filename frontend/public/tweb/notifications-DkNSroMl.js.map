{"version":3,"file":"notifications-DkNSroMl.js","sources":["../src/components/rangeSelectorTsx.tsx","../src/components/rangeSettingSelector.tsx","../src/components/sidebarLeft/tabs/notifications.tsx"],"sourcesContent":["/*\r\n * https://github.com/morethanwords/tweb\r\n * Copyright (C) 2019-2021 Eduard Kuzmenko\r\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\r\n */\r\n\r\nimport {createSignal, onMount, onCleanup, createEffect} from 'solid-js';\r\nimport attachGrabListeners, {GrabEvent} from '../helpers/dom/attachGrabListeners';\r\nimport clamp from '../helpers/number/clamp';\r\nimport I18n from '../lib/langPack';\r\n\r\nexport interface RangeSelectorProps {\r\n  step: number;\r\n  min?: number;\r\n  max?: number;\r\n  withTransition?: boolean;\r\n  useTransform?: boolean;\r\n  vertical?: boolean;\r\n  useProperty?: boolean;\r\n  offsetAxisValue?: number;\r\n  value?: number;\r\n  onMouseDown?: (event: GrabEvent) => void;\r\n  onMouseUp?: (event: GrabEvent) => void;\r\n  onScrub?: (value: number) => void;\r\n}\r\n\r\nexport default function RangeSelector(props: RangeSelectorProps) {\r\n  const [mousedown, setMousedown] = createSignal(false);\r\n  const [rect, setRect] = createSignal<DOMRect>();\r\n  const [value, setValue] = createSignal(props.value || 0);\r\n  let containerRef: HTMLDivElement;\r\n  let filledRef: HTMLDivElement;\r\n  let seekRef: HTMLInputElement;\r\n  let removeListeners: (() => void) | null = null;\r\n\r\n  const min = props.min ?? 0;\r\n  const max = props.max ?? 0;\r\n  const step = props.step;\r\n  const withTransition = props.withTransition || false;\r\n  const useTransform = props.useTransform || false;\r\n  const useProperty = props.useProperty || false;\r\n  const vertical = props.vertical || false;\r\n  const offsetAxisValue = props.offsetAxisValue || 0;\r\n\r\n  const stepStr = '' + step;\r\n  const index = stepStr.indexOf('.');\r\n  const decimals = index === -1 ? 0 : stepStr.length - index - 1;\r\n\r\n  const setFilled = (val: number) => {\r\n    let percents = (val - min) / (max - min);\r\n    percents = clamp(percents, 0, 1);\r\n\r\n    // using scaleX and width even with vertical because it will be rotated\r\n    if(useTransform) {\r\n      filledRef.style.transform = `scaleX(${percents})`;\r\n    } else if(useProperty) {\r\n      containerRef.style.setProperty('--progress', '' + percents);\r\n    } else {\r\n      filledRef.style.width = (percents * 100) + '%';\r\n    }\r\n  };\r\n\r\n  const setProgress = (val: number) => {\r\n    seekRef.value = '' + val;\r\n    setFilled(+seekRef.value); // clamp\r\n    setValue(+seekRef.value);\r\n  };\r\n\r\n  const onInput = () => {\r\n    const val = +seekRef.value;\r\n    setFilled(val);\r\n    setValue(val);\r\n    props.onScrub?.(val);\r\n  };\r\n\r\n  const onMouseMove = (event: GrabEvent) => {\r\n    scrub(event);\r\n  };\r\n\r\n  const onMouseDown = (event: GrabEvent) => {\r\n    setRect(containerRef.getBoundingClientRect());\r\n    setMousedown(true);\r\n    scrub(event);\r\n    containerRef.classList.add('is-focused');\r\n    props.onMouseDown?.(event);\r\n  };\r\n\r\n  const onMouseUp = (event: GrabEvent) => {\r\n    setMousedown(false);\r\n    containerRef.classList.remove('is-focused');\r\n    props.onMouseUp?.(event);\r\n  };\r\n\r\n  const scrub = (event: GrabEvent, snapValue?: (value: number) => number) => {\r\n    const currentRect = rect();\r\n    if(!currentRect) return 0;\r\n\r\n    let rectMax = vertical ? currentRect.height : currentRect.width;\r\n\r\n    if(offsetAxisValue) {\r\n      rectMax -= offsetAxisValue;\r\n    }\r\n\r\n    let offsetAxisValue_ = clamp(\r\n      vertical ?\r\n        -(event.y - currentRect.bottom) :\r\n        event.x - currentRect.left - offsetAxisValue / 2,\r\n      0,\r\n      rectMax\r\n    );\r\n\r\n    if(!vertical && I18n.isRTL) {\r\n      offsetAxisValue_ = rectMax - offsetAxisValue_;\r\n    }\r\n\r\n    let val = min + (offsetAxisValue_ / rectMax * (max - min));\r\n\r\n    if((val - min) < ((max - min) / 2)) {\r\n      val -= step / 10;\r\n    }\r\n\r\n    val = +val.toFixed(decimals);\r\n    val = clamp(val, min, max);\r\n    if(snapValue) val = snapValue(val);\r\n\r\n    setProgress(val);\r\n    props.onScrub?.(val);\r\n\r\n    return val;\r\n  };\r\n\r\n  onMount(() => {\r\n    // Set initial value\r\n    if(props.value) {\r\n      setProgress(props.value);\r\n    }\r\n\r\n    removeListeners = attachGrabListeners(containerRef, onMouseDown, onMouseMove, onMouseUp);\r\n  });\r\n\r\n  onCleanup(() => {\r\n    removeListeners?.();\r\n  });\r\n\r\n  // Update value when props change\r\n  createEffect(() => {\r\n    if(props.value !== undefined) {\r\n      setProgress(props.value);\r\n    }\r\n  });\r\n\r\n  return (\r\n    <div\r\n      ref={containerRef!}\r\n      class={`progress-line ${useTransform ? 'use-transform' : ''} ${withTransition ? 'with-transition' : ''}`}\r\n    >\r\n      <div ref={filledRef!} class=\"progress-line__filled\" />\r\n      <input\r\n        ref={seekRef!}\r\n        class=\"progress-line__seek\"\r\n        type=\"range\"\r\n        step={step}\r\n        min={min}\r\n        max={max}\r\n        value={value()}\r\n        onInput={onInput}\r\n      />\r\n    </div>\r\n  );\r\n}\r\n","import {createEffect, createSignal, JSX} from 'solid-js';\r\nimport RangeSelector from './rangeSelectorTsx';\r\n\r\nexport default function RangeSettingSelector(props: {\r\n  textLeft: JSX.Element,\r\n  textRight: (value: number) => JSX.Element,\r\n  step: number\r\n  value: number\r\n  minValue: number\r\n  maxValue: number\r\n  onChange?: (value: number) => void,\r\n  onMouseUp?: () => void\r\n}) {\r\n  const [value, setValue] = createSignal(props.value);\r\n\r\n  createEffect(() => {\r\n    setValue(props.value);\r\n  });\r\n\r\n  return (\r\n    <div class=\"range-setting-selector\">\r\n      <div class=\"range-setting-selector-details\">\r\n        <div class=\"range-setting-selector-name\">{props.textLeft}</div>\r\n        <div class=\"range-setting-selector-value\">{props.textRight(value())}</div>\r\n      </div>\r\n      <RangeSelector\r\n        step={props.step}\r\n        min={props.minValue}\r\n        max={props.maxValue}\r\n        value={props.value}\r\n        onScrub={(value) => {\r\n          props.onChange?.(value);\r\n          setValue(value);\r\n        }}\r\n        onMouseUp={props.onMouseUp}\r\n      />\r\n    </div>\r\n  );\r\n}\r\n","import {SETTINGS_INIT} from '../../../config/state';\r\nimport copy from '../../../helpers/object/copy';\r\nimport {subscribeOn} from '../../../helpers/solid/subscribeOn';\r\nimport convertKeyToInputKey from '../../../helpers/string/convertKeyToInputKey';\r\nimport {InputNotifyPeer, InputPeerNotifySettings, PeerNotifySettings, Update} from '../../../layer';\r\nimport {i18n, LangPackKey} from '../../../lib/langPack';\r\nimport {MUTE_UNTIL} from '../../../lib/mtproto/mtproto_config';\r\nimport rootScope from '../../../lib/rootScope';\r\nimport {useAppSettings} from '../../../stores/appSettings';\r\nimport CheckboxFieldTsx from '../../checkboxFieldTsx';\r\nimport RangeSettingSelector from '../../rangeSettingSelector';\r\nimport Row from '../../rowTsx';\r\nimport Section from '../../section';\r\nimport {createEffect, createMemo, createSignal, getOwner, onCleanup, runWithOwner} from 'solid-js';\r\nimport {toastNew} from '../../toast';\r\nimport Button from '../../buttonTsx';\r\nimport cancelEvent from '../../../helpers/dom/cancelEvent';\r\nimport {useHotReloadGuard} from '../../../lib/solidjs/hotReloadGuard';\r\n\r\ntype InputNotifyKey = Exclude<InputNotifyPeer['_'], 'inputNotifyPeer' | 'inputNotifyForumTopic'>;\r\n\r\nconst NotifySection = (props: {\r\n  name: LangPackKey,\r\n  typeText: LangPackKey,\r\n  inputKey: InputNotifyKey,\r\n}) => {\r\n  const [enabled, setEnabled] = createSignal(true);\r\n  const [showPreviews, setShowPreviews] = createSignal(true);\r\n  const [notifySettings, setNotifySettings] = createSignal<PeerNotifySettings>();\r\n  const inputNotifyPeer = {_: props.inputKey};\r\n\r\n  createEffect(async() => {\r\n    const _notifySettings = notifySettings();\r\n    if(!_notifySettings) {\r\n      return;\r\n    }\r\n\r\n    const muted = await rootScope.managers.appNotificationsManager.isMuted(_notifySettings);\r\n    setEnabled(!muted);\r\n    setShowPreviews(!!_notifySettings.show_previews);\r\n\r\n    return muted;\r\n  });\r\n\r\n  onCleanup(async() => {\r\n    const mute = !enabled();\r\n    const _showPreviews = showPreviews();\r\n    const _notifySettings = notifySettings();\r\n    const isMuted = await rootScope.managers.appNotificationsManager.isMuted(_notifySettings);\r\n    if(\r\n      mute === isMuted &&\r\n      _showPreviews === _notifySettings.show_previews\r\n    ) {\r\n      return;\r\n    }\r\n\r\n    const inputSettings: InputPeerNotifySettings = copy(_notifySettings) as any;\r\n    inputSettings._ = 'inputPeerNotifySettings';\r\n    inputSettings.mute_until = mute ? MUTE_UNTIL : 0;\r\n    inputSettings.show_previews = _showPreviews;\r\n    rootScope.managers.appNotificationsManager.updateNotifySettings(\r\n      inputNotifyPeer,\r\n      inputSettings\r\n    );\r\n  });\r\n\r\n  subscribeOn(rootScope)('notify_settings', (update: Update.updateNotifySettings) => {\r\n    const inputKey = convertKeyToInputKey(update.peer._) as any;\r\n    if(props.inputKey === inputKey) {\r\n      setNotifySettings(update.notify_settings);\r\n    }\r\n  });\r\n\r\n  const ret = rootScope.managers.appNotificationsManager.getNotifySettings(inputNotifyPeer);\r\n  (ret instanceof Promise ? ret : Promise.resolve(ret)).then((_notifySettings) => {\r\n    if(!notifySettings()) {\r\n      setNotifySettings(_notifySettings);\r\n    }\r\n  });\r\n\r\n  return (\r\n    <Section name={props.name}>\r\n      <Row>\r\n        <Row.CheckboxFieldToggle>\r\n          <CheckboxFieldTsx checked={enabled()} onChange={setEnabled} toggle />\r\n        </Row.CheckboxFieldToggle>\r\n        <Row.Title>{i18n(props.typeText)}</Row.Title>\r\n      </Row>\r\n      <Row>\r\n        <Row.CheckboxFieldToggle>\r\n          <CheckboxFieldTsx checked={showPreviews()} onChange={setShowPreviews} toggle />\r\n        </Row.CheckboxFieldToggle>\r\n        <Row.Title>{i18n('MessagePreview')}</Row.Title>\r\n      </Row>\r\n    </Section>\r\n  );\r\n};\r\n\r\nconst OtherSection = () => {\r\n  const [contactJoined, setContactJoined] = createSignal(true);\r\n  const owner = getOwner();\r\n  rootScope.managers.appNotificationsManager.getContactSignUpNotification().then((enabled) => {\r\n    setContactJoined(enabled);\r\n\r\n    runWithOwner(owner, () => onCleanup(() => {\r\n      const _enabled = contactJoined();\r\n      if(_enabled !== enabled) {\r\n        rootScope.managers.appNotificationsManager.setContactSignUpNotification(!_enabled);\r\n      }\r\n    }));\r\n  });\r\n\r\n  return (\r\n    <Section name=\"NotificationsOther\">\r\n      <Row>\r\n        <Row.CheckboxFieldToggle>\r\n          <CheckboxFieldTsx\r\n            checked={contactJoined()}\r\n            onChange={setContactJoined}\r\n            toggle\r\n          />\r\n        </Row.CheckboxFieldToggle>\r\n        <Row.Title>{i18n('ContactJoined')}</Row.Title>\r\n      </Row>\r\n    </Section>\r\n  );\r\n};\r\n\r\nconst NotificationsSection = () => {\r\n  const {uiNotificationsManager} = useHotReloadGuard();\r\n  const [appSettings, setAppSettings] = useAppSettings();\r\n  const [permission, setPermission] = createSignal<NotificationPermission>(Notification.permission);\r\n  const isGranted = createMemo(() => permission() === 'granted');\r\n\r\n  const onClick = (e: MouseEvent) => {\r\n    cancelEvent(e);\r\n    // const now = Date.now();\r\n    Notification.requestPermission().then((permission) => {\r\n      setPermission(permission);\r\n      if(permission === 'granted') {\r\n        uiNotificationsManager.onPushConditionsChange();\r\n      } else {\r\n        throw 1;\r\n      }\r\n    }, () => {\r\n      // if((Date.now() - now) < 100) {\r\n      toastNew({langPackKey: 'Notifications.Restricted'});\r\n      // }\r\n    });\r\n  };\r\n\r\n  const NotificationRow = (props: Parameters<typeof Row>[0]) => {\r\n    return (\r\n      <Row\r\n        {...props}\r\n        fakeDisabled={!isGranted()}\r\n        clickable={!isGranted() && onClick}\r\n      />\r\n    );\r\n  };\r\n\r\n  const NotificationCheckbox = (props: Parameters<typeof CheckboxFieldTsx>[0]) => {\r\n    return (\r\n      <CheckboxFieldTsx\r\n        {...props}\r\n        checked={isGranted() && props.checked}\r\n      />\r\n    );\r\n  };\r\n\r\n  return (\r\n    <Section\r\n      name=\"Notifications.Web\"\r\n      caption={isGranted() ? 'MultiAccount.ShowNotificationsFromCaption' : 'Notifications.Default'}\r\n    >\r\n      <NotificationRow>\r\n        <Row.CheckboxFieldToggle>\r\n          <NotificationCheckbox\r\n            checked={appSettings.notifications.desktop}\r\n            onChange={(value) => setAppSettings('notifications', 'desktop', value)}\r\n            toggle\r\n          />\r\n        </Row.CheckboxFieldToggle>\r\n        <Row.Title>{i18n('Notifications.Show')}</Row.Title>\r\n      </NotificationRow>\r\n      <NotificationRow>\r\n        <Row.CheckboxFieldToggle>\r\n          <NotificationCheckbox\r\n            checked={appSettings.notifications.push}\r\n            onChange={(value) => setAppSettings('notifications', 'push', value)}\r\n            toggle\r\n          />\r\n        </Row.CheckboxFieldToggle>\r\n        <Row.Title>{i18n('Notifications.Offline')}</Row.Title>\r\n      </NotificationRow>\r\n      <NotificationRow>\r\n        <Row.CheckboxFieldToggle>\r\n          <NotificationCheckbox\r\n            checked={appSettings.notifyAllAccounts}\r\n            onChange={(value) => setAppSettings('notifyAllAccounts', value)}\r\n            toggle\r\n          />\r\n        </Row.CheckboxFieldToggle>\r\n        <Row.Title>{i18n('MultiAccount.AllAccounts')}</Row.Title>\r\n      </NotificationRow>\r\n      {!isGranted() && (\r\n        <Button\r\n          text=\"Notifications.Enable\"\r\n          class=\"btn-primary primary btn-transparent\"\r\n          icon=\"unmute\"\r\n          disabled={isGranted()}\r\n          onClick={onClick}\r\n        />\r\n      )}\r\n    </Section>\r\n  );\r\n};\r\n\r\nconst SoundSection = () => {\r\n  const {uiNotificationsManager} = useHotReloadGuard();\r\n  const [appSettings, setAppSettings] = useAppSettings();\r\n\r\n  return (\r\n    <Section\r\n      name=\"Notifications.Sound.Section\"\r\n      caption=\"Notifications.Sound.Caption\"\r\n    >\r\n      <Row>\r\n        <Row.CheckboxFieldToggle>\r\n          <CheckboxFieldTsx\r\n            checked={appSettings.notifications.sound}\r\n            onChange={(value) => {\r\n              if(value && !appSettings.notifications.volume) {\r\n                setAppSettings('notifications', 'volume', SETTINGS_INIT.notifications.volume);\r\n              }\r\n\r\n              setAppSettings('notifications', 'sound', value);\r\n            }}\r\n            toggle\r\n          />\r\n        </Row.CheckboxFieldToggle>\r\n        <Row.Title>{i18n('Notifications.Sound')}</Row.Title>\r\n      </Row>\r\n      <RangeSettingSelector\r\n        textLeft={i18n('Notifications.Sound.Volume')}\r\n        textRight={(value) => '' + Math.floor(value * 100) + '%'}\r\n        step={0.01}\r\n        value={appSettings.notifications.volume}\r\n        minValue={0}\r\n        maxValue={1}\r\n        onChange={(value) => {\r\n          value = +value.toFixed(2);\r\n          if(!value) {\r\n            setAppSettings('notifications', 'sound', false);\r\n          }\r\n\r\n          setAppSettings('notifications', 'volume', value);\r\n        }}\r\n        onMouseUp={() => {\r\n          uiNotificationsManager.testSound(appSettings.notifications.volume);\r\n        }}\r\n      />\r\n    </Section>\r\n  );\r\n};\r\n\r\nconst SoundEffectsSection = () => {\r\n  const [appSettings, setAppSettings] = useAppSettings();\r\n\r\n  return (\r\n    <Section name=\"Notifications.Sound.Effects\">\r\n      <Row>\r\n        <Row.CheckboxFieldToggle>\r\n          <CheckboxFieldTsx\r\n            checked={appSettings.notifications.sentMessageSound}\r\n            onChange={(value) => setAppSettings('notifications', 'sentMessageSound', value)}\r\n            toggle\r\n          />\r\n        </Row.CheckboxFieldToggle>\r\n        <Row.Title>{i18n('Notifications.Sound.Sent')}</Row.Title>\r\n      </Row>\r\n    </Section>\r\n  );\r\n};\r\n\r\nconst Notifications = () => {\r\n  return (\r\n    <>\r\n      <NotificationsSection />\r\n      <SoundSection />\r\n      <SoundEffectsSection />\r\n      <NotifySection\r\n        name=\"NotificationsPrivateChats\"\r\n        typeText=\"NotificationsForPrivateChats\"\r\n        inputKey=\"inputNotifyUsers\"\r\n      />\r\n      <NotifySection\r\n        name=\"NotificationsGroups\"\r\n        typeText=\"NotificationsForGroups\"\r\n        inputKey=\"inputNotifyChats\"\r\n      />\r\n      <NotifySection\r\n        name=\"NotificationsChannels\"\r\n        typeText=\"NotificationsForChannels\"\r\n        inputKey=\"inputNotifyBroadcasts\"\r\n      />\r\n      <OtherSection />\r\n    </>\r\n  );\r\n}\r\n\r\nexport default Notifications;\r\n"],"names":["RangeSelector","props","mousedown","setMousedown","createSignal","rect","setRect","value","setValue","containerRef","filledRef","seekRef","removeListeners","min","max","step","withTransition","useTransform","useProperty","vertical","offsetAxisValue","stepStr","index","indexOf","decimals","length","setFilled","val","percents","clamp","style","transform","setProperty","width","setProgress","onInput","onScrub","onMouseMove","event","scrub","onMouseDown","getBoundingClientRect","classList","add","onMouseUp","remove","snapValue","currentRect","rectMax","height","offsetAxisValue_","y","bottom","x","left","I18n","isRTL","toFixed","onMount","attachGrabListeners","onCleanup","createEffect","undefined","_el$","_tmpl$","_el$2","firstChild","_el$3","nextSibling","_ref$","_$use","_$className","_ref$2","$$input","_ref$3","_$setAttribute","_$effect","_$delegateEvents","RangeSettingSelector","_el$4","_$insert","textLeft","textRight","_$createComponent","minValue","maxValue","onChange","NotifySection","enabled","setEnabled","showPreviews","setShowPreviews","notifySettings","setNotifySettings","inputNotifyPeer","_","inputKey","_notifySettings","muted","rootScope","managers","appNotificationsManager","isMuted","show_previews","mute","_showPreviews","inputSettings","copy","mute_until","MUTE_UNTIL","updateNotifySettings","subscribeOn","update","convertKeyToInputKey","peer","notify_settings","ret","getNotifySettings","Promise","resolve","then","Section","name","children","Row","CheckboxFieldToggle","CheckboxFieldTsx","checked","toggle","Title","i18n","typeText","OtherSection","contactJoined","setContactJoined","owner","getOwner","getContactSignUpNotification","runWithOwner","_enabled","setContactSignUpNotification","NotificationsSection","uiNotificationsManager","useHotReloadGuard","appSettings","setAppSettings","useAppSettings","permission","setPermission","Notification","isGranted","createMemo","onClick","e","cancelEvent","requestPermission","onPushConditionsChange","toastNew","langPackKey","NotificationRow","_$mergeProps","fakeDisabled","clickable","NotificationCheckbox","caption","notifications","desktop","push","notifyAllAccounts","_$memo","Button","text","icon","disabled","SoundSection","sound","volume","SETTINGS_INIT","Math","floor","testSound","SoundEffectsSection","sentMessageSound","Notifications"],"mappings":"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"}