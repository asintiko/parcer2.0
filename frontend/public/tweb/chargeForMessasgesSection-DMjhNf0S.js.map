{"version":3,"file":"chargeForMessasgesSection-DMjhNf0S.js","sources":["../src/components/sidebarRight/tabs/groupPermissions/chargeForMessasgesSection.tsx"],"sourcesContent":["import {Component, ComponentProps, createComputed, createEffect, createSignal, Show} from 'solid-js';\r\nimport {render} from 'solid-js/web';\r\nimport {Transition} from 'solid-transition-group';\r\n\r\nimport type SolidJSHotReloadGuardProvider from '../../../../lib/solidjs/hotReloadGuardProvider';\r\nimport {i18n} from '../../../../lib/langPack';\r\n\r\nimport useStarsCommissionAndWithdrawalPrice from '../../../sidebarLeft/tabs/privacy/messages/useStarsCommissionAndWithdrawalPrice';\r\nimport {PromiseCollector} from '../../../solidJsTabs/promiseCollector';\r\nimport StarRangeInput from '../../../sidebarLeft/tabs/privacy/messages/starsRangeInput';\r\nimport StaticSwitch from '../../../staticSwitch';\r\nimport Section from '../../../section';\r\nimport Row from '../../../rowTsx';\r\n\r\n\r\nconst TRANSITION_PARAMS: KeyframeAnimationOptions = {duration: 200, easing: 'ease-out'};\r\n\r\nconst ChargeForMessasgesSection: Component<{\r\n  initialStars: number;\r\n  onStarsChange: (amount: number) => void;\r\n}> = (props) => {\r\n  const [checked, setChecked] = createSignal(!!props.initialStars);\r\n  const [stars, setStars] = createSignal(props.initialStars || 0);\r\n\r\n  const {commissionPercents, willReceiveDollars} = useStarsCommissionAndWithdrawalPrice(stars);\r\n\r\n  createComputed(() => {\r\n    if(checked()) {\r\n      setStars(prev => prev || props.initialStars || 1);\r\n    } else {\r\n      setStars(0);\r\n    }\r\n  });\r\n\r\n  let first = true;\r\n  createEffect(() => {\r\n    if(first) {\r\n      first = false;\r\n      stars();\r\n      return;\r\n    }\r\n\r\n    props.onStarsChange(stars());\r\n  });\r\n\r\n  return (\r\n    <>\r\n      <Section caption='PaidMessages.ChargeForGroupMessagesDescription'>\r\n        <Row clickable={() => {setChecked(p => !p)}}>\r\n          <Row.Title>{i18n('PaidMessages.ChargeForMessages')}</Row.Title>\r\n          <Row.RightContent><StaticSwitch checked={checked()} /></Row.RightContent>\r\n        </Row>\r\n      </Section>\r\n      <Transition\r\n        onEnter={async(el, done) => {\r\n          const height = el.scrollHeight;\r\n          await el.animate({height: ['0px', height + 'px']}, TRANSITION_PARAMS).finished;\r\n\r\n          done();\r\n        }}\r\n        onExit={async(el, done) => {\r\n          const height = el.clientHeight;\r\n          await el.animate({\r\n            height: [height + 'px', '0px'],\r\n            opacity: [1, 0]\r\n          }, TRANSITION_PARAMS).finished;\r\n\r\n          done();\r\n        }}\r\n      >\r\n        <Show when={checked()}>\r\n          <Section\r\n            name='PaidMessages.SetPrice'\r\n            class='overflow-hidden'\r\n            caption='PaidMessages.SetPriceGroupDescription'\r\n            captionArgs={[\r\n              commissionPercents(),\r\n              willReceiveDollars()\r\n            ]}\r\n          >\r\n            <StarRangeInput value={stars()} onChange={setStars} />\r\n          </Section>\r\n        </Show>\r\n      </Transition>\r\n    </>\r\n  );\r\n};\r\n\r\nconst createChargeForMessasgesSection = (\r\n  props: ComponentProps<typeof ChargeForMessasgesSection>,\r\n  HotReloadProvider: typeof SolidJSHotReloadGuardProvider\r\n) => {\r\n  const element = document.createElement('div');\r\n\r\n  const promiseCollectorHelper = PromiseCollector.createHelper();\r\n\r\n  const dispose = render(() => (\r\n    <HotReloadProvider>\r\n      <PromiseCollector onCollect={promiseCollectorHelper.onCollect}>\r\n        <ChargeForMessasgesSection {...props} />\r\n      </PromiseCollector>\r\n    </HotReloadProvider>\r\n  ), element);\r\n\r\n  return {\r\n    element,\r\n    dispose,\r\n    promise: promiseCollectorHelper.await()\r\n  }\r\n};\r\n\r\nexport default createChargeForMessasgesSection;\r\n"],"names":["TRANSITION_PARAMS","duration","easing","ChargeForMessasgesSection","props","checked","setChecked","createSignal","initialStars","stars","setStars","commissionPercents","willReceiveDollars","useStarsCommissionAndWithdrawalPrice","createComputed","prev","first","createEffect","onStarsChange","_$createComponent","Section","caption","children","Row","clickable","p","Title","i18n","RightContent","StaticSwitch","Transition","onEnter","el","done","height","scrollHeight","animate","finished","onExit","clientHeight","opacity","Show","when","name","captionArgs","StarRangeInput","value","onChange","createChargeForMessasgesSection","HotReloadProvider","element","document","createElement","promiseCollectorHelper","PromiseCollector","createHelper","dispose","render","onCollect","promise","await"],"mappings":"83BAeA,MAAMA,EAA8C,CAACC,SAAU,IAAKC,OAAQ,UAAU,EAEhFC,EAGAC,GAAU,CACd,KAAM,CAACC,EAASC,CAAU,EAAIC,EAAa,CAAC,CAACH,EAAMI,YAAY,EACzD,CAACC,EAAOC,CAAQ,EAAIH,EAAaH,EAAMI,cAAgB,CAAC,EAExD,CAACG,mBAAAA,EAAoBC,mBAAAA,CAAkB,EAAIC,EAAqCJ,CAAK,EAE3FK,EAAe,IAAM,CAChBT,EAAO,EACRK,EAASK,GAAQA,GAAQX,EAAMI,cAAgB,CAAC,EAEhDE,EAAS,CAAC,CAEd,CAAC,EAED,IAAIM,EAAQ,GACZC,OAAAA,EAAa,IAAM,CACjB,GAAGD,EAAO,CACRA,EAAQ,GACRP,IACA,MACF,CAEAL,EAAMc,cAAcT,EAAK,CAAE,CAC7B,CAAC,EAEDU,CAAAA,EAEKC,EAAO,CAACC,QAAO,iDAAA,IAAAC,UAAA,CAAA,OAAAH,EACbI,EAAG,CAACC,UAAWA,IAAM,CAAClB,EAAWmB,GAAK,CAACA,CAAC,CAAE,EAAA,IAAAH,UAAA,CAAA,MAAA,CAAAH,EACxCI,EAAIG,MAAK,CAAA,IAAAJ,UAAA,CAAA,OAAEK,EAAK,gCAAgC,CAAC,CAAA,CAAA,EAAAR,EACjDI,EAAIK,aAAY,CAAA,IAAAN,UAAA,CAAA,OAAAH,EAAEU,EAAY,CAAA,IAACxB,SAAO,CAAA,OAAEA,EAAO,CAAE,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,EAAAc,EAAAA,EAGrDW,EAAU,CACTC,QAAS,MAAMC,EAAIC,IAAS,CAC1B,MAAMC,EAASF,EAAGG,aAClB,MAAMH,EAAGI,QAAQ,CAACF,OAAQ,CAAC,MAAOA,EAAS,IAAI,CAAC,EAAGlC,CAAiB,EAAEqC,SAEtEJ,GACD,EACDK,OAAQ,MAAMN,EAAIC,IAAS,CACzB,MAAMC,EAASF,EAAGO,aAClB,MAAMP,EAAGI,QAAQ,CACfF,OAAQ,CAACA,EAAS,KAAM,KAAK,EAC7BM,QAAS,CAAC,EAAG,CAAC,CAChB,EAAGxC,CAAiB,EAAEqC,SAEtBJ,GACD,EAAA,IAAAX,UAAA,CAAA,OAAAH,EAEAsB,EAAI,CAAA,IAACC,MAAI,CAAA,OAAErC,EAAO,CAAE,EAAA,IAAAiB,UAAA,CAAA,OAAAH,EAClBC,EAAO,CACNuB,KAAI,wBAAA,MAAA,kBAEJtB,QAAO,wCAAA,IACPuB,aAAW,CAAA,MAAE,CACXjC,EAAkB,EAClBC,EAAkB,CAAE,CACrB,EAAA,IAAAU,UAAA,CAAA,OAAAH,EAEA0B,EAAc,CAAA,IAACC,OAAK,CAAA,OAAErC,EAAK,CAAE,EAAEsC,SAAUrC,CAAQ,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAM9D,EAEMsC,EAAkCA,CACtC5C,EACA6C,IACG,CACH,MAAMC,EAAUC,SAASC,cAAc,KAAK,EAEtCC,EAAyBC,EAAiBC,eAE1CC,EAAUC,EAAO,IAAAtC,EACpB8B,EAAiB,CAAA,IAAA3B,UAAA,CAAA,OAAAH,EACfmC,EAAgB,CAAA,IAACI,WAAS,CAAA,OAAEL,EAAuBK,SAAS,EAAA,IAAApC,UAAA,CAAA,OAAAH,EAC1DhB,EAA8BC,CAAK,CAAA,CAAA,CAAA,CAAA,EAGzC,EAAE8C,CAAO,EAEV,MAAO,CACLA,QAAAA,EACAM,QAAAA,EACAG,QAASN,EAAuBO,MAAM,EAE1C"}