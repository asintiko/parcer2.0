{"version":3,"file":"publishTimeField-CBJxowyg.js","sources":["../src/components/chat/suggestPostPopup/popupSchedulePost.ts","../src/components/chat/suggestPostPopup/publishTimeField.tsx"],"sourcesContent":["import {formatTime} from '../../../helpers/date';\r\nimport {i18n} from '../../../lib/langPack';\r\nimport PopupSchedule from '../../popups/schedule';\r\nimport styles from './styles.module.scss';\r\n\r\n\r\nconst MILLIS_IN_MINUTE = 60 * 1000;\r\n\r\ntype Args = {\r\n  minTimeDate: Date;\r\n} & ConstructorParameters<typeof PopupSchedule>[0];\r\n\r\nexport default class PopupSchedulePost extends PopupSchedule {\r\n  protected caption: HTMLElement;\r\n  protected minTimeDate: Date;\r\n\r\n  constructor(args: Args) {\r\n    const {minTimeDate, ...rest} = args;\r\n\r\n    super(rest);\r\n\r\n    this.minTimeDate = minTimeDate;\r\n\r\n    this.caption = document.createElement('div');\r\n    this.caption.classList.add(styles.Caption, styles.center);\r\n    this.caption.append(i18n('SuggestedPosts.PublishingTime.MinSendTime', [formatTime(minTimeDate)]));\r\n\r\n    this.timeDiv.after(this.caption);\r\n  }\r\n\r\n  public setTimeTitle() {\r\n    super.setTimeTitle();\r\n\r\n    if(!this.caption || !this.minTimeDate) return;\r\n\r\n    const sendDate = new Date(this.selectedDate.getTime());\r\n    sendDate.setHours(+this.hoursInputField.value, +this.minutesInputField.value);\r\n\r\n    const disabled = sendDate < new Date() || (sendDate.valueOf() / MILLIS_IN_MINUTE | 0) < (this.minTimeDate.valueOf() / MILLIS_IN_MINUTE | 0);\r\n\r\n    this.btnConfirm.toggleAttribute('disabled', disabled);\r\n\r\n    const isCaptionVisible = sendDate.getDate() === this.minTimeDate.getDate();\r\n    this.caption.classList.toggle('hide', !isCaptionVisible);\r\n  }\r\n}\r\n","import {formatFullSentTime} from '../../../helpers/date';\r\nimport {I18nTsx} from '../../../helpers/solid/i18n';\r\nimport {LangPackKey} from '../../../lib/langPack';\r\nimport {ButtonIconTsx} from '../../buttonIconTsx';\r\nimport {IconTsx} from '../../iconTsx';\r\nimport SimpleFormField from '../../simpleFormField';\r\nimport styles from './commonStyles.module.scss';\r\nimport PopupSchedulePost from './popupSchedulePost';\r\n\r\n\r\ntype Props = {\r\n  value: number;\r\n  onChange: (value: number | undefined) => void;\r\n  noTimeLangKey: LangPackKey;\r\n};\r\n\r\nconst PUBLISH_MIN_DELAY_MINUTES = 10;\r\n\r\nconst PublishTimeField = (props: Props) => {\r\n  const onContainerClick = () => {\r\n    const minTimeDate = new Date();\r\n    minTimeDate.setMinutes(minTimeDate.getMinutes() + PUBLISH_MIN_DELAY_MINUTES);\r\n\r\n    const minDate = new Date(minTimeDate);\r\n    minDate.setHours(0, 0, 0, 0);\r\n\r\n    new PopupSchedulePost({\r\n      initDate: new Date(minTimeDate),\r\n      minDate,\r\n      minTimeDate,\r\n      onPick: (timestamp) => {\r\n        console.log(timestamp);\r\n        props.onChange(timestamp);\r\n      }\r\n    }).show();\r\n  };\r\n\r\n  const onCrossClick = (event: MouseEvent) => {\r\n    event.stopPropagation();\r\n    props.onChange(undefined);\r\n  };\r\n\r\n  return (\r\n    <SimpleFormField\r\n      clickable\r\n      withEndButtonIcon={!!props.value}\r\n      onClick={onContainerClick}\r\n    >\r\n      <SimpleFormField.InputStub>\r\n        {props.value ?\r\n          <span>{formatFullSentTime(props.value)}</span> :\r\n          <I18nTsx key={props.noTimeLangKey} />\r\n        }\r\n      </SimpleFormField.InputStub>\r\n      <SimpleFormField.Label active>\r\n        <I18nTsx key='SuggestedPosts.PublishingTime.Label' />\r\n      </SimpleFormField.Label>\r\n      <SimpleFormField.SideContent last>\r\n        {props.value ?\r\n          <ButtonIconTsx icon='cross' tabIndex={-1} onClick={onCrossClick} /> :\r\n          <IconTsx class={styles.Icon} icon='down' />\r\n        }\r\n      </SimpleFormField.SideContent>\r\n    </SimpleFormField>\r\n  )\r\n};\r\n\r\nexport default PublishTimeField;\r\n"],"names":["MILLIS_IN_MINUTE","PopupSchedulePost","PopupSchedule","args","minTimeDate","rest","styles","i18n","formatTime","sendDate","disabled","isCaptionVisible","PUBLISH_MIN_DELAY_MINUTES","PublishTimeField","props","onContainerClick","Date","setMinutes","getMinutes","minDate","setHours","initDate","onPick","timestamp","console","log","onChange","show","onCrossClick","event","stopPropagation","undefined","_$createComponent","SimpleFormField","clickable","withEndButtonIcon","value","onClick","children","InputStub","_$memo","_el$","_tmpl$","_$insert","formatFullSentTime","I18nTsx","key","noTimeLangKey","Label","active","SideContent","last","ButtonIconTsx","icon","tabIndex","IconTsx","Icon"],"mappings":"sZAMMA,EAAmB,GAAK,IAM9B,MAAqBC,UAA0BC,CAAc,CAI3D,YAAYC,EAAY,CACtB,KAAM,CAAC,YAAAC,EAAa,GAAGC,CAAA,EAAQF,EAE/B,MAAME,CAAI,EAEV,KAAK,YAAcD,EAEd,KAAA,QAAU,SAAS,cAAc,KAAK,EAC3C,KAAK,QAAQ,UAAU,IAAIE,EAAO,QAASA,EAAO,MAAM,EACnD,KAAA,QAAQ,OAAOC,EAAK,4CAA6C,CAACC,EAAWJ,CAAW,CAAC,CAAC,CAAC,EAE3F,KAAA,QAAQ,MAAM,KAAK,OAAO,CACjC,CAEO,cAAe,CAGpB,GAFA,MAAM,aAAa,EAEhB,CAAC,KAAK,SAAW,CAAC,KAAK,YAAa,OAEvC,MAAMK,EAAW,IAAI,KAAK,KAAK,aAAa,SAAS,EAC5CA,EAAA,SAAS,CAAC,KAAK,gBAAgB,MAAO,CAAC,KAAK,kBAAkB,KAAK,EAE5E,MAAMC,EAAWD,EAAe,IAAA,OAAWA,EAAS,QAAY,EAAAT,EAAmB,IAAM,KAAK,YAAY,QAAA,EAAYA,EAAmB,GAEpI,KAAA,WAAW,gBAAgB,WAAYU,CAAQ,EAEpD,MAAMC,EAAmBF,EAAS,QAAA,IAAc,KAAK,YAAY,UACjE,KAAK,QAAQ,UAAU,OAAO,OAAQ,CAACE,CAAgB,CACzD,CACF,qBC7BMC,EAA4B,GAE5BC,EAAoBC,GAAiB,CACzC,MAAMC,EAAmBA,IAAM,CAC7B,MAAMX,EAAc,IAAIY,KACxBZ,EAAYa,WAAWb,EAAYc,WAAY,EAAGN,CAAyB,EAE3E,MAAMO,EAAU,IAAIH,KAAKZ,CAAW,EACpCe,EAAQC,SAAS,EAAG,EAAG,EAAG,CAAC,EAE3B,IAAInB,EAAkB,CACpBoB,SAAU,IAAIL,KAAKZ,CAAW,EAC9Be,QAAAA,EACAf,YAAAA,EACAkB,OAASC,GAAc,CACrBC,QAAQC,IAAIF,CAAS,EACrBT,EAAMY,SAASH,CAAS,CAC1B,CACF,CAAC,EAAEI,KAAI,GAGHC,EAAgBC,GAAsB,CAC1CA,EAAMC,gBAAe,EACrBhB,EAAMY,SAASK,MAAS,GAG1B,OAAAC,EACGC,EAAe,CACdC,UAAS,GAAA,IACTC,mBAAiB,CAAA,MAAE,CAAC,CAACrB,EAAMsB,KAAK,EAChCC,QAAStB,EAAgB,IAAAuB,UAAA,CAAA,MAAA,CAAAN,EAExBC,EAAgBM,UAAS,CAAA,IAAAD,UAAA,CAAA,OACvBE,EAAA,IAAA,CAAA,CAAA1B,EAAMsB,KAAK,EAAA,GAAA,IAAA,CAAA,MAAAK,EAAAC,IAAAC,OAAAA,EAAAF,EACHG,IAAAA,EAAmB9B,EAAMsB,KAAK,CAAC,EAAAK,IAAAT,EAAAA,EACrCa,EAAO,CAAA,IAACC,KAAG,CAAA,OAAEhC,EAAMiC,aAAa,EAAI,CAAA,CAAA,CAAA,EAAAf,EAGxCC,EAAgBe,MAAK,CAACC,OAAM,GAAA,IAAAX,UAAA,CAAA,OAAAN,EAC1Ba,EAAO,CAACC,IAAG,qCAAA,CAAA,CAAA,CAAA,CAAA,EAAAd,EAEbC,EAAgBiB,YAAW,CAACC,KAAI,GAAA,IAAAb,UAAA,CAAA,OAC9BE,QAAA1B,EAAMsB,KAAK,EAAAJ,EAAAA,EACToB,EAAa,CAACC,KAAI,QAASC,SAAU,GAAIjB,QAAST,EAAYI,EAAAA,EAC9DuB,EAAO,CAAA,IAAA,OAAA,CAAA,OAAQjD,EAAOkD,IAAI,EAAEH,KAAI,OAAU,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAKrD"}