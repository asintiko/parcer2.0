const __vite__fileDeps=["pageEmailRecover-nElKUYLe.js","index-DkTXgRzn.js","index-D6yfGClC.css","page-DHZ4rwAT.js","emailSetup-B7XgbVnq.js","classNames-CN4lTu6a.js","iconTsx-CzZ0kHhc.js","transition-FQI3RYKM.js","emailSetup-Cdnpduwy.css","loginPage-c7QmqPht.js","putPreloader-B1AiiTEr.js","htmlToSpan-DhAls8qz.js","wrapDuration-BzvpFTxS.js","toast-Du-4fzOe.js","pageSignIn-DzUNepoK.js","pageSignQR-BM1301zW.js","countryInputField-ChXEz7Bm.js","pageIm-L8AZDBuv.js"],__vite__mapDeps=i=>i.map(i=>__vite__fileDeps[i]);
import{d as i,B as R,q as b,P as S,k,_ as f,h as v,m as E,u as I,j as K,w as T,v as F,x as N}from"./index-DkTXgRzn.js";import{p as M}from"./putPreloader-B1AiiTEr.js";import{P as x}from"./page-DHZ4rwAT.js";import{L as D,S as u}from"./loginPage-c7QmqPht.js";import{h as C}from"./htmlToSpan-DhAls8qz.js";import{a as O,w as W,f as V}from"./wrapDuration-BzvpFTxS.js";import{t as _}from"./toast-Du-4fzOe.js";import z from"./pageSignIn-DzUNepoK.js";import"./pageSignQR-BM1301zW.js";import"./countryInputField-ChXEz7Bm.js";let n,r;const j=()=>{const w=new D({className:"page-password",withInputWrapper:!0,titleLangKey:"Login.Password.Title",subtitleLangKey:"Login.Password.Subtitle"}),o=R("btn-primary btn-color-primary"),s=new b.IntlElement({key:"Login.Next"});o.append(s.element);const t=new S({label:"LoginPassword",name:"password"});n=t.input;let g=!1;const y=k("ForgotPassword",[O(()=>{g||(g=!0,i.managers.passwordManager.requestRecovery().then(e=>f(()=>import("./pageEmailRecover-nElKUYLe.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16])).then(a=>{a.default.mount({email_pattern:e.email_pattern})})).catch(async e=>{if(e.type==="PASSWORD_RECOVERY_NA"){await u.show({titleLangKey:"Login.ResetPassword.Title",descriptionLangKey:"Login.ResetPassword.NoEmailText",button:{langKey:"Login.ResetPassword.ResetAccount",isDanger:!0}}),await u.show({titleLangKey:"Login.ResetAccount.Title",descriptionLangKey:"Login.ResetAccount.Text",button:{langKey:"Login.ResetPassword.ResetAccount",isDanger:!0}}),await i.managers.appAccountManager.deleteAccount("Forgot password").then(()=>{z.mount()}).catch(a=>{if(a.type==="2FA_RECENT_CONFIRM")u.show({titleLangKey:"Login.ResetAccountFail.Title",descriptionLangKey:"Login.ResetAccountFail.TextCancelled",button:{langKey:"OK"}});else if(a.type.startsWith("2FA_CONFIRM_WAIT_")){const p=+a.type.replace("2FA_CONFIRM_WAIT_","");u.show({titleLangKey:"Login.ResetAccountFail.Title",descriptionLangKey:"Login.ResetAccountFail.TextWait",descriptionArgs:[W(V(p))],button:{langKey:"OK"}})}else console.error(a),_({langPackKey:"Error.AnError"})});return}_({langPackKey:"Error.AnError"})}).finally(()=>{g=!1}))})]);y.classList.add("forgot-link"),w.inputWrapper.append(t.container,y,o);let d;const m=()=>(d||(d=window.setInterval(m,1e4)),i.managers.passwordManager.getState().then(e=>{l=e,l.hint?K(t.label,C(T(l.hint))):t.setLabel()}));let l;const L=e=>{if(e&&F(e),!n.value.length){n.classList.add("error");return}const a=N([n,o],!0),p=n.value;s.update({key:"PleaseWait"});const h=M(o);t.setValueSilently(""+Math.random()),t.setValueSilently(p),i.managers.passwordManager.check(p,l).then(c=>{switch(c._){case"auth.authorization":clearInterval(d),f(()=>import("./pageIm-L8AZDBuv.js"),__vite__mapDeps([17,1,2,3])).then(P=>{P.default.mount()}),r&&r.remove();break;default:o.removeAttribute("disabled"),s.update({key:c._}),h.remove();break}}).catch(c=>{switch(a(),t.input.classList.add("error"),c.type){default:s.update({key:"PASSWORD_HASH_INVALID"}),n.select();break}h.remove(),m()})};v(o,L),n.addEventListener("keypress",function(e){if(this.classList.remove("error"),s.update({key:"Login.Next"}),e.key==="Enter")return L()});const A=E.isMobile?100:166;return r=new I(t,A),w.imageDiv.append(r.container),Promise.all([r.load(),m()])},Z=new x("page-password",!0,j,()=>{r?.load()},()=>{n.focus(),i.managers.appStateManager.pushToState("authState",{_:"authStatePassword"})});export{Z as default};
//# sourceMappingURL=pagePassword-BYl8xcIr.js.map
