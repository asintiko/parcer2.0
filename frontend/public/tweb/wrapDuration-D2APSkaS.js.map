{"version":3,"file":"wrapDuration-D2APSkaS.js","sources":["../src/helpers/dom/anchorCallback.ts","../src/helpers/formatDuration.ts","../src/helpers/string/toHHMMSS.ts","../src/components/wrappers/wrapDuration.ts"],"sourcesContent":["import cancelEvent from './cancelEvent';\r\n\r\nexport default function anchorCallback(callback: (e: MouseEvent) => any, _cancelEvent = true) {\r\n  const a = document.createElement('a');\r\n  a.href = '#';\r\n  a.onclick = (e) => {\r\n    _cancelEvent && cancelEvent(e);\r\n    callback(e);\r\n  };\r\n  return a;\r\n}\r\n","/*\r\n * https://github.com/morethanwords/tweb\r\n * Copyright (C) 2019-2021 Eduard Kuzmenko\r\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\r\n */\r\n\r\nexport enum DurationType {\r\n  Seconds,\r\n  Minutes,\r\n  Hours,\r\n  Days,\r\n  Weeks,\r\n  Months,\r\n  Years\r\n}\r\n\r\nexport default function formatDuration(duration: number, showLast = 2) {\r\n  if(!duration) {\r\n    duration = 1;\r\n  }\r\n\r\n  const d: {duration: number, type: DurationType}[] = [];\r\n  const p = [\r\n    {m: 1, t: DurationType.Seconds},\r\n    {m: 60, t: DurationType.Minutes},\r\n    {m: 60, t: DurationType.Hours},\r\n    {m: 24, t: DurationType.Days},\r\n    {m: 7, t: DurationType.Weeks}\r\n  ] as Array<{m?: number, t: DurationType}>\r\n  const s = 1;\r\n  let t = s;\r\n  p.forEach((o, idx) => {\r\n    t = Math.round(t * o.m);\r\n\r\n    if(duration < t) {\r\n      return;\r\n    }\r\n\r\n    let dd = duration / t;\r\n    if(idx !== (p.length - 1)) {\r\n      const modulus = p[idx === (p.length - 1) ? idx : idx + 1].m;\r\n      dd %= modulus;\r\n    }\r\n\r\n    d.push({\r\n      duration: dd | 0,\r\n      type: o.t\r\n    });\r\n  });\r\n\r\n  const out = d.slice(-showLast).reverse();\r\n  for(let i = out.length - 1; i >= 0; --i) {\r\n    if(out[i].duration === 0) {\r\n      out.splice(i, 1);\r\n    }\r\n  }\r\n\r\n  return out;\r\n}\r\n","export default function toHHMMSS(str: string | number, leadZero = false) {\r\n  const sec_num = parseInt(str + '', 10);\r\n  let hours: any = Math.floor(sec_num / 3600);\r\n  let minutes: any = Math.floor((sec_num - (hours * 3600)) / 60);\r\n  let seconds: any = sec_num - (hours * 3600) - (minutes * 60);\r\n\r\n  if(hours && hours < 10 && leadZero) hours = '0' + hours;\r\n  if(minutes < 10 && (hours || leadZero)) minutes ='0' + minutes;\r\n  if(seconds < 10) seconds = '0' + seconds;\r\n  return (hours ? hours + ':' : '') + minutes + ':' + seconds;\r\n}\r\n","/*\r\n * https://github.com/morethanwords/tweb\r\n * Copyright (C) 2019-2021 Eduard Kuzmenko\r\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\r\n */\r\n\r\nimport I18n, {LangPackKey, i18n, join} from '../../lib/langPack';\r\nimport formatDuration, {DurationType} from '../../helpers/formatDuration';\r\nimport toHHMMSS from '../../helpers/string/toHHMMSS';\r\n\r\nexport const DURATION_LANG_KEYS: {[type in DurationType]: LangPackKey} = {\r\n  [DurationType.Seconds]: 'Seconds',\r\n  [DurationType.Minutes]: 'Minutes',\r\n  [DurationType.Hours]: 'Hours',\r\n  [DurationType.Days]: 'Days',\r\n  [DurationType.Weeks]: 'Weeks',\r\n  [DurationType.Months]: 'Months',\r\n  [DurationType.Years]: 'Years'\r\n};\r\n\r\nexport function wrapFormattedDuration(formatted: ReturnType<typeof formatDuration>, plain: true): string;\r\nexport function wrapFormattedDuration(formatted: ReturnType<typeof formatDuration>, plain?: false): HTMLSpanElement;\r\nexport function wrapFormattedDuration(formatted: ReturnType<typeof formatDuration>, plain?: boolean): string | HTMLSpanElement;\r\n\r\nexport function wrapFormattedDuration(formatted: ReturnType<typeof formatDuration>, plain?: boolean): string | HTMLSpanElement {\r\n  if(plain) {\r\n    const strings = formatted.map((d) => I18n.format(DURATION_LANG_KEYS[d.type], true, [d.duration]));\r\n    return join(strings, false, plain);\r\n  }\r\n\r\n  const elements = formatted.map((d) => i18n(DURATION_LANG_KEYS[d.type], [d.duration]));\r\n\r\n  const fragment = document.createElement('span');\r\n  fragment.append(...join(elements, false));\r\n\r\n  return fragment;\r\n}\r\n\r\nexport function wrapCallDuration(duration: number, plain?: boolean) {\r\n  return wrapFormattedDuration(formatDuration(duration, 2), plain);\r\n}\r\n\r\nexport function wrapLeftDuration(timeLeft: number) {\r\n  const formatted = formatDuration(timeLeft, 3);\r\n  if(formatted[0].type <= DurationType.Hours) {\r\n    return toHHMMSS(timeLeft, true);\r\n  } else {\r\n    formatted.splice(1, Infinity);\r\n    return wrapFormattedDuration(formatted);\r\n  }\r\n}\r\n\r\nexport function wrapSlowModeLeftDuration(timeLeft: number) {\r\n  const formatted = formatDuration(timeLeft, 3);\r\n  if(formatted[0].type === DurationType.Seconds) {\r\n    return wrapFormattedDuration(formatted);\r\n  } else {\r\n    return toHHMMSS(timeLeft, true);\r\n  }\r\n}\r\n"],"names":["anchorCallback","callback","_cancelEvent","a","e","cancelEvent","DurationType","DurationType2","formatDuration","duration","showLast","d","p","t","o","idx","dd","modulus","out","i","toHHMMSS","str","leadZero","sec_num","hours","minutes","seconds","DURATION_LANG_KEYS","wrapFormattedDuration","formatted","plain","strings","I18n","join","elements","i18n","fragment","wrapCallDuration","wrapLeftDuration","timeLeft","wrapSlowModeLeftDuration"],"mappings":"8DAEwB,SAAAA,EAAeC,EAAkCC,EAAe,GAAM,CACtF,MAAAC,EAAI,SAAS,cAAc,GAAG,EACpC,OAAAA,EAAE,KAAO,IACPA,EAAA,QAAWC,GAAM,CACjBF,GAAgBG,EAAYD,CAAC,EAC7BH,EAASG,CAAC,CAAA,EAELD,CACT,CCJY,IAAAG,GAAAA,IACVA,EAAAC,EAAA,QAAA,CAAA,EAAA,UACAD,EAAAC,EAAA,QAAA,CAAA,EAAA,UACAD,EAAAC,EAAA,MAAA,CAAA,EAAA,QACAD,EAAAC,EAAA,KAAA,CAAA,EAAA,OACAD,EAAAC,EAAA,MAAA,CAAA,EAAA,QACAD,EAAAC,EAAA,OAAA,CAAA,EAAA,SACAD,EAAAC,EAAA,MAAA,CAAA,EAAA,QAPUD,IAAAA,GAAA,CAAA,CAAA,EAUY,SAAAE,EAAeC,EAAkBC,EAAW,EAAG,CACjED,IACSA,EAAA,GAGb,MAAME,EAA8C,CAAA,EAC9CC,EAAI,CACR,CAAC,EAAG,EAAG,EAAG,CAAoB,EAC9B,CAAC,EAAG,GAAI,EAAG,CAAoB,EAC/B,CAAC,EAAG,GAAI,EAAG,CAAkB,EAC7B,CAAC,EAAG,GAAI,EAAG,CAAiB,EAC5B,CAAC,EAAG,EAAG,EAAG,CAAkB,CAAA,EAG9B,IAAIC,EADM,EAERD,EAAA,QAAQ,CAACE,EAAGC,IAAQ,CAGpB,GAFAF,EAAI,KAAK,MAAMA,EAAIC,EAAE,CAAC,EAEnBL,EAAWI,EACZ,OAGF,IAAIG,EAAKP,EAAWI,EACjB,GAAAE,IAASH,EAAE,OAAS,EAAI,CACnB,MAAAK,EAAUL,EAAEG,IAASH,EAAE,OAAS,EAAKG,EAAMA,EAAM,CAAC,EAAE,EACpDC,GAAAC,CACR,CAEAN,EAAE,KAAK,CACL,SAAUK,EAAK,EACf,KAAMF,EAAE,CAAA,CACT,CAAA,CACF,EAED,MAAMI,EAAMP,EAAE,MAAM,CAACD,CAAQ,EAAE,UAC/B,QAAQS,EAAID,EAAI,OAAS,EAAGC,GAAK,EAAG,EAAEA,EACjCD,EAAIC,CAAC,EAAE,WAAa,GACjBD,EAAA,OAAOC,EAAG,CAAC,EAIZ,OAAAD,CACT,CC1DwB,SAAAE,EAASC,EAAsBC,EAAW,GAAO,CACvE,MAAMC,EAAU,SAASF,EAAM,GAAI,EAAE,EACrC,IAAIG,EAAa,KAAK,MAAMD,EAAU,IAAI,EACtCE,EAAe,KAAK,OAAOF,EAAWC,EAAQ,MAAS,EAAE,EACzDE,EAAeH,EAAWC,EAAQ,KAASC,EAAU,GAEtD,OAAAD,GAASA,EAAQ,IAAMF,IAAUE,EAAQ,IAAMA,GAC/CC,EAAU,KAAOD,GAASF,KAAWG,EAAS,IAAMA,GACpDC,EAAU,KAAIA,EAAU,IAAMA,IACzBF,EAAQA,EAAQ,IAAM,IAAMC,EAAU,IAAMC,CACtD,CCAO,MAAMC,EAA4D,CACvE,CAACrB,EAAa,OAAO,EAAG,UACxB,CAACA,EAAa,OAAO,EAAG,UACxB,CAACA,EAAa,KAAK,EAAG,QACtB,CAACA,EAAa,IAAI,EAAG,OACrB,CAACA,EAAa,KAAK,EAAG,QACtB,CAACA,EAAa,MAAM,EAAG,SACvB,CAACA,EAAa,KAAK,EAAG,OACxB,EAMgB,SAAAsB,EAAsBC,EAA8CC,EAA2C,CAC7H,GAAGA,EAAO,CACR,MAAMC,EAAUF,EAAU,IAAKlB,GAAMqB,EAAK,OAAOL,EAAmBhB,EAAE,IAAI,EAAG,GAAM,CAACA,EAAE,QAAQ,CAAC,CAAC,EACzF,OAAAsB,EAAKF,EAAS,GAAOD,CAAK,CACnC,CAEA,MAAMI,EAAWL,EAAU,IAAKlB,GAAMwB,EAAKR,EAAmBhB,EAAE,IAAI,EAAG,CAACA,EAAE,QAAQ,CAAC,CAAC,EAE9EyB,EAAW,SAAS,cAAc,MAAM,EAC9C,OAAAA,EAAS,OAAO,GAAGH,EAAKC,EAAU,EAAK,CAAC,EAEjCE,CACT,CAEgB,SAAAC,EAAiB5B,EAAkBqB,EAAiB,CAClE,OAAOF,EAAsBpB,EAAeC,EAAU,CAAC,EAAGqB,CAAK,CACjE,CAEO,SAASQ,EAAiBC,EAAkB,CAC3C,MAAAV,EAAYrB,EAAe+B,EAAU,CAAC,EAC5C,OAAGV,EAAU,CAAC,EAAE,MAAQvB,EAAa,MAC5Bc,EAASmB,EAAU,EAAI,GAEpBV,EAAA,OAAO,EAAG,GAAQ,EACrBD,EAAsBC,CAAS,EAE1C,CAEO,SAASW,EAAyBD,EAAkB,CACnD,MAAAV,EAAYrB,EAAe+B,EAAU,CAAC,EAC5C,OAAGV,EAAU,CAAC,EAAE,OAASvB,EAAa,QAC7BsB,EAAsBC,CAAS,EAE/BT,EAASmB,EAAU,EAAI,CAElC"}