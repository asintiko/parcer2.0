{"version":3,"file":"enterPasswordTab-WhzPJd9z.js","sources":["../src/components/sidebarLeft/tabs/passcodeLock/enterPasswordTab.tsx"],"sourcesContent":["import {createEffect, createSignal, onCleanup} from 'solid-js';\r\n\r\nimport {MAX_PASSCODE_LENGTH} from '../../../../lib/passcode/constants';\r\nimport {usePasscodeActions} from '../../../../lib/passcode/actions';\r\n\r\nimport Section from '../../../section';\r\nimport {InputFieldTsx} from '../../../inputFieldTsx';\r\nimport Space from '../../../space';\r\nimport {i18n} from '../../../../lib/langPack';\r\nimport ripple from '../../../ripple'; ripple; // keep\r\nimport PasswordInputField from '../../../passwordInputField';\r\nimport {useSuperTab} from '../../../solidJsTabs/superTabProvider';\r\nimport type {AppPasscodeEnterPasswordTab} from '../../../solidJsTabs';\r\n\r\nimport LottieAnimation from './lottieAnimation';\r\n\r\nimport commonStyles from './common.module.scss';\r\n\r\n\r\ntype AppPasscodeEnterPasswordTabClass = typeof AppPasscodeEnterPasswordTab;\r\n\r\nconst EnterPasswordTab = () => {\r\n  const [tab] = useSuperTab<AppPasscodeEnterPasswordTabClass>();\r\n  const actions = usePasscodeActions();\r\n\r\n  let inputField: PasswordInputField;\r\n\r\n  const [value, setValue] = createSignal('');\r\n  const [isError, setIsError] = createSignal(false);\r\n\r\n  createEffect(() => {\r\n    value();\r\n    setIsError(false);\r\n  });\r\n\r\n  setTimeout(() => {\r\n    inputField.input.focus();\r\n  }, 400); // Smaller timeout will make the tab animation jerky\r\n\r\n  onCleanup(() => {\r\n    // Just in case\r\n    setValue('');\r\n    (inputField.input as HTMLInputElement).value = '';\r\n  });\r\n\r\n  const canSubmit = () => value() && value().length <= MAX_PASSCODE_LENGTH;\r\n\r\n  let isSubmitting = false;\r\n  async function onSubmit(e: Event) {\r\n    e.preventDefault();\r\n\r\n    if(!canSubmit() || isSubmitting) return;\r\n    isSubmitting = true;\r\n\r\n    try {\r\n      await tab.payload.onSubmit(value(), tab, actions);\r\n    } catch{\r\n      setIsError(true);\r\n    } finally {\r\n      isSubmitting = false;\r\n    }\r\n  }\r\n\r\n  return (\r\n    <Section caption=\"PasscodeLock.Notice\">\r\n      <LottieAnimation name=\"UtyanPasscode\" />\r\n\r\n      <Space amount=\"1.125rem\" />\r\n\r\n      <form\r\n        action=\"\"\r\n        autocomplete=\"off\"\r\n        onSubmit={onSubmit}\r\n      >\r\n        <div class={commonStyles.AdditionalPadding}>\r\n          <InputFieldTsx\r\n            InputFieldClass={PasswordInputField}\r\n            instanceRef={(ref) => void (inputField = ref)}\r\n            maxLength={MAX_PASSCODE_LENGTH}\r\n            autocomplete=\"off\"\r\n            value={value()}\r\n            errorLabel={isError() ? 'PasscodeLock.PasscodesDontMatch' : undefined}\r\n            label={tab.payload.inputLabel}\r\n            onRawInput={setValue}\r\n          />\r\n        </div>\r\n\r\n        <Space amount=\"1rem\" />\r\n\r\n        <div class={commonStyles.AdditionalPadding}>\r\n          <button\r\n            use:ripple\r\n            type=\"submit\"\r\n            class=\"btn-primary btn-color-primary btn-large\"\r\n            disabled={!canSubmit()}\r\n          >\r\n            {i18n(tab.payload.buttonText)}\r\n          </button>\r\n        </div>\r\n      </form>\r\n\r\n      <Space amount=\"1rem\" />\r\n    </Section>\r\n  );\r\n};\r\n\r\nexport default EnterPasswordTab;\r\n"],"names":["EnterPasswordTab","tab","useSuperTab","actions","usePasscodeActions","inputField","value","setValue","createSignal","isError","setIsError","createEffect","setTimeout","input","focus","onCleanup","canSubmit","length","MAX_PASSCODE_LENGTH","isSubmitting","onSubmit","e","preventDefault","payload","_$createComponent","Section","caption","children","LottieAnimation","name","Space","amount","_el$","_tmpl$","_el$2","firstChild","_el$3","nextSibling","_el$4","addEventListener","_$insert","InputFieldTsx","InputFieldClass","PasswordInputField","instanceRef","ref","maxLength","autocomplete","errorLabel","undefined","label","inputLabel","onRawInput","_$use","ripple","i18n","buttonText","_$effect","_p$","_v$","commonStyles","AdditionalPadding","_v$2","_v$3","_$className","disabled"],"mappings":"g+BAqBMA,GAAmBA,IAAM,CAC7B,KAAM,CAACC,CAAG,EAAIC,IACRC,EAAUC,IAEhB,IAAIC,EAEJ,KAAM,CAACC,EAAOC,CAAQ,EAAIC,EAAa,EAAE,EACnC,CAACC,EAASC,CAAU,EAAIF,EAAa,EAAK,EAEhDG,EAAa,IAAM,CACjBL,IACAI,EAAW,EAAK,CAClB,CAAC,EAEDE,WAAW,IAAM,CACfP,EAAWQ,MAAMC,OAClB,EAAE,GAAG,EAENC,EAAU,IAAM,CAEdR,EAAS,EAAE,EACVF,EAAWQ,MAA2BP,MAAQ,EACjD,CAAC,EAED,MAAMU,EAAYA,IAAMV,EAAK,GAAMA,EAAO,EAACW,QAAUC,EAErD,IAAIC,EAAe,GACnB,eAAeC,EAASC,EAAU,CAGhC,GAFAA,EAAEC,eAAc,EAEb,GAACN,KAAeG,GACnBA,CAAAA,EAAe,GAEf,GAAI,CACF,MAAMlB,EAAIsB,QAAQH,SAASd,EAAK,EAAIL,EAAKE,CAAO,CAClD,MAAO,CACLO,EAAW,EAAI,CACjB,QAAU,CACRS,EAAe,EACjB,EACF,CAEA,OAAAK,EACGC,EAAO,CAACC,QAAO,sBAAA,IAAAC,UAAA,CAAA,MAAAH,CAAAA,EACbI,EAAe,CAACC,KAAI,gBAAAL,EAAAA,EAEpBM,EAAK,CAACC,OAAM,UAAA,CAAA,GAAA,IAAA,CAAA,MAAAC,EAAAC,EAAA,EAAAC,EAAAF,EAAAG,WAAAC,EAAAF,EAAAG,YAAAC,EAAAF,EAAAD,WAAAH,OAAAA,EAAAO,iBAAA,SAKDnB,CAAQ,EAAAoB,EAAAN,EAAAV,EAGfiB,EAAa,CACZC,gBAAiBC,EACjBC,YAAcC,GAAQ,KAAMxC,EAAawC,GACzCC,UAAW5B,EACX6B,aAAY,MAAA,IACZzC,OAAK,CAAA,OAAEA,EAAK,CAAE,EAAA,IACd0C,YAAU,CAAA,OAAEvC,EAAO,EAAK,kCAAoCwC,MAAS,EAAA,IACrEC,OAAK,CAAA,OAAEjD,EAAIsB,QAAQ4B,UAAU,EAC7BC,WAAY7C,CAAQ,CAAA,CAAA,EAAAiC,EAAAR,EAAAR,EAIvBM,EAAK,CAACC,OAAM,MAAA,CAAA,EAAAK,CAAA,EAAAiB,EAILC,EAAMhB,EAAA,IAAA,EAAA,EAAAE,EAAAF,EAAA,IAKTiB,EAAKtD,EAAIsB,QAAQiC,UAAU,CAAC,EAAAC,EAAAC,GAAA,CAAA,MAAAC,EAtBrBC,EAAaC,kBAAiBC,EAe9BF,EAAaC,kBAAiBE,EAK5B,CAAC/C,IAAW2C,OAAAA,IAAAD,EAAAC,KAAAK,EAAA9B,EAAAwB,EAAAC,IAAAA,CAAA,EAAAG,IAAAJ,EAAAI,MAAAE,EAAA5B,EAAAsB,EAAAI,KAAAA,CAAA,EAAAC,IAAAL,EAAAK,OAAAzB,EAAA2B,SAAAP,EAAAK,KAAAA,GAAAL,CAAA,EAAA,CAAAC,IAAAV,OAAAa,KAAAb,OAAAc,KAAAd,MAAA,CAAA,EAAAjB,IAAAR,EAAAA,EAO3BM,EAAK,CAACC,OAAM,MAAA,CAAA,CAAA,CAAA,CAAA,CAAA,CAGnB"}