{"version":3,"file":"index-Dl3K6UDl.js","sources":["../src/components/simpleFormField/index.tsx"],"sourcesContent":["import {Accessor, batch, createContext, createSignal, JSX, onMount, ParentProps, Ref, Setter, splitProps, useContext} from 'solid-js';\r\nimport {requestRAF} from '../../helpers/solid/requestRAF';\r\nimport styles from './styles.module.scss';\r\n\r\n\r\ntype SimpleFormFieldContextValue = {\r\n  input: Accessor<HTMLInputElement>;\r\n  setInput: Setter<HTMLInputElement>;\r\n  offsetElement: Accessor<HTMLElement>;\r\n  setOffsetElement: Setter<HTMLElement>;\r\n  value: Accessor<string>;\r\n  onChange: (value: string) => void;\r\n};\r\n\r\nconst Context = createContext<SimpleFormFieldContextValue>();\r\n\r\nconst SimpleFormField = (inProps: ParentProps<{\r\n  value?: string;\r\n  onChange?: (value: string) => void;\r\n\r\n  onClick?: JSX.EventHandler<HTMLDivElement, MouseEvent>;\r\n  isError?: boolean;\r\n  clickable?: boolean;\r\n  withEndButtonIcon?: boolean;\r\n} & Omit<JSX.HTMLAttributes<HTMLDivElement>, 'onChange' | 'onClick'>>) => {\r\n  const [props, restProps] = splitProps(inProps, ['value', 'onChange', 'isError', 'children', 'onClick', 'class', 'classList', 'clickable', 'withEndButtonIcon']);\r\n  const [input, setInput] = createSignal<HTMLInputElement>();\r\n  const [offsetElement, setOffsetElement] = createSignal<HTMLElement>();\r\n\r\n  const contextValue: SimpleFormFieldContextValue = {\r\n    input,\r\n    setInput,\r\n    offsetElement,\r\n    setOffsetElement,\r\n    value: () => props.value,\r\n    get onChange() {\r\n      return props.onChange;\r\n    }\r\n  };\r\n\r\n  return (\r\n    <Context.Provider value={contextValue}>\r\n      <div\r\n        class={styles.Container}\r\n        classList={{\r\n          [styles.error]: props.isError,\r\n          [styles.clickable]: props.clickable,\r\n          [props.class]: !!props.class,\r\n          [styles.withEndButtonIcon]: props.withEndButtonIcon,\r\n          ...props.classList\r\n        }}\r\n        onClick={(...args) => {\r\n          contextValue.input()?.focus();\r\n          props.onClick?.(...args);\r\n        }}\r\n        {...restProps}\r\n      >\r\n        <div class={styles.BorderThin} />\r\n        <div class={styles.BorderThick} />\r\n        {props.children}\r\n      </div>\r\n    </Context.Provider>\r\n  );\r\n};\r\n\r\nSimpleFormField.Input = (inProps: {\r\n  ref?: Ref<HTMLInputElement>;\r\n  forceFieldValue?: boolean;\r\n} & Omit<JSX.InputHTMLAttributes<HTMLInputElement>, 'value' | 'onChange' | 'onInput' | 'ref'>) => {\r\n  const [props, restProps] = splitProps(inProps, ['ref', 'class', 'classList', 'forceFieldValue']);\r\n\r\n  const context = useContext(Context);\r\n\r\n  return (\r\n    <input\r\n      ref={(el) => batch(() => {\r\n        context.setInput(el);\r\n        context.setOffsetElement(el);\r\n        if(props.ref instanceof Function) props.ref(el);\r\n      })}\r\n      class={styles.Input}\r\n      classList={{\r\n        [props.class]: !!props.class,\r\n        ...props.classList\r\n      }}\r\n      value={context.value()}\r\n      onInput={(e) => {\r\n        context.onChange(e.currentTarget.value)\r\n        if(props.forceFieldValue) context.input().value = context.value();\r\n      }}\r\n      {...restProps}\r\n    />\r\n  );\r\n};\r\n\r\nSimpleFormField.InputStub = (props: ParentProps) => {\r\n  const context = useContext(Context);\r\n\r\n  return (\r\n    <div\r\n      ref={context.setOffsetElement}\r\n      class={styles.InputStub}\r\n    >\r\n      {props.children}\r\n    </div>\r\n  );\r\n};\r\n\r\nSimpleFormField.Label = (props: ParentProps<{\r\n  active?: boolean;\r\n  forceOffset?: number;\r\n}>) => {\r\n  const context = useContext(Context);\r\n\r\n  const [offset, setOffset] = createSignal(0);\r\n  const [noTransition, setNoTransition] = createSignal(true);\r\n\r\n  onMount(() => {\r\n    if(props.forceOffset || !context.offsetElement()) return;\r\n    const parentElement = context.offsetElement().parentElement;\r\n    if(!parentElement) return;\r\n\r\n    const rect = parentElement.getBoundingClientRect();\r\n    const inputRect = context.offsetElement().getBoundingClientRect();\r\n    setOffset(inputRect.left - rect.left);\r\n  });\r\n\r\n  onMount(() => {\r\n    requestRAF(() => {\r\n      setNoTransition(false);\r\n    });\r\n  });\r\n\r\n  return (\r\n    <div\r\n      class={styles.Label}\r\n      classList={{\r\n        [styles.active]: props.active || !!context.value(),\r\n        [styles.noTransition]: noTransition()\r\n      }}\r\n      style={{\r\n        '--offset': `${props.forceOffset || offset()}px`\r\n      }}\r\n    >\r\n      {props.children}\r\n    </div>\r\n  );\r\n};\r\n\r\nSimpleFormField.SideContent = (props: ParentProps<{\r\n  first?: boolean;\r\n  last?: boolean;\r\n}>) => {\r\n  return (\r\n    <div class={styles.SideContent} classList={{\r\n      [styles.first]: props.first,\r\n      [styles.last]: props.last\r\n    }}>\r\n      {props.children}\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default SimpleFormField;\r\n"],"names":["Context","createContext","SimpleFormField","inProps","props","restProps","splitProps","input","setInput","createSignal","offsetElement","setOffsetElement","contextValue","value","onChange","_$createComponent","Provider","children","_el$","_tmpl$","_el$2","firstChild","_el$3","nextSibling","$$click","args","focus","onClick","_$spread","_$mergeProps","styles","Container","classList","error","isError","clickable","class","withEndButtonIcon","_$insert","_$effect","_p$","_v$","BorderThin","_v$2","BorderThick","_$className","undefined","Input","context","useContext","_el$4","_tmpl$2","$$input","e","currentTarget","forceFieldValue","_$use","el","batch","ref","Function","InputStub","_el$5","_tmpl$3","_ref$","Label","offset","setOffset","noTransition","setNoTransition","onMount","forceOffset","parentElement","rect","getBoundingClientRect","inputRect","left","requestRAF","_el$6","_v$3","_v$4","active","_v$5","_$classList","style","setProperty","removeProperty","SideContent","_el$7","_v$6","_v$7","first","last","_$delegateEvents"],"mappings":"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"}