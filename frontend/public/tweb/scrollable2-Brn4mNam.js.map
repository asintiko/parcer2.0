{"version":3,"file":"scrollable2-Brn4mNam.js","sources":["../src/components/scrollable2.tsx"],"sourcesContent":["/*\r\n * https://github.com/morethanwords/tweb\r\n * Copyright (C) 2019-2021 Eduard Kuzmenko\r\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\r\n */\r\n\r\nimport {children, createContext, createEffect, createMemo, createSignal, JSX, on, onCleanup, Ref} from 'solid-js';\r\nimport {IS_OVERLAY_SCROLL_SUPPORTED} from '../environment/overlayScrollSupport';\r\nimport IS_TOUCH_SUPPORTED from '../environment/touchSupport';\r\nimport {IS_MOBILE_SAFARI, IS_SAFARI} from '../environment/userAgent';\r\nimport cancelEvent from '../helpers/dom/cancelEvent';\r\nimport classNames from '../helpers/string/classNames';\r\nimport useHeavyAnimationCheck from '../hooks/useHeavyAnimationCheck';\r\n\r\nconst SCROLL_THROTTLE = /* IS_ANDROID ? 200 :  */24;\r\nconst USE_OWN_SCROLL = !IS_OVERLAY_SCROLL_SUPPORTED;\r\n\r\nlet throttleMeasurement: (callback: () => void) => number,\r\n  cancelMeasurement: (id: number) => void;\r\nif(USE_OWN_SCROLL) {\r\n  throttleMeasurement = (callback) => requestAnimationFrame(callback);\r\n  cancelMeasurement = (id) => cancelAnimationFrame(id);\r\n} else {\r\n  throttleMeasurement = (callback) => window.setTimeout(callback, SCROLL_THROTTLE);\r\n  cancelMeasurement = (id) => window.clearTimeout(id);\r\n}\r\n\r\nexport type ScrollableContextValue = {\r\n  scrollPosition: number,\r\n  scrollSize: number,\r\n  clientSize: number,\r\n  offsetSize: number,\r\n  getDistanceToEnd: () => number,\r\n  container: HTMLDivElement,\r\n  onSizeChange: () => void,\r\n  setScrollPositionSilently: (value: number) => void\r\n};\r\n\r\nexport const ScrollableContext = createContext<ScrollableContextValue>();\r\n\r\nexport default function Scrollable(props: {\r\n  children: JSX.Element,\r\n  ref?: Ref<HTMLDivElement>,\r\n  thumbRef?: (el: HTMLDivElement) => void,\r\n  class?: string,\r\n  classList?: JSX.HTMLAttributes<HTMLDivElement>['classList'],\r\n  axis?: 'x' | 'y',\r\n  withBorders?: 'both' | 'top' | 'bottom' | 'manual',\r\n  onScrolledTop?: () => void,\r\n  onScrolledBottom?: () => void,\r\n  onScroll?: () => void,\r\n  onScrollOffset?: number,\r\n  relative?: boolean\r\n}) {\r\n  const axis = props.axis ?? 'y';\r\n  const scrollPositionProperty: 'scrollTop' | 'scrollLeft' = axis === 'x' ? 'scrollLeft' : 'scrollTop';\r\n  const scrollSizeProperty: 'scrollHeight' | 'scrollWidth' = axis === 'x' ? 'scrollWidth' : 'scrollHeight';\r\n  const clientSizeProperty: 'clientHeight' | 'clientWidth' = axis === 'x' ? 'clientWidth' : 'clientHeight';\r\n  const offsetSizeProperty: 'offsetHeight' | 'offsetWidth' = axis === 'x' ? 'offsetWidth' : 'offsetHeight';\r\n  const clientAxis: 'clientY' | 'clientX' = axis === 'x' ? 'clientX' : 'clientY';\r\n\r\n  const [ignoreScrollEvent, setIgnoreScrollEvent] = createSignal(false);\r\n  const scrollPosition = () => ref[scrollPositionProperty];\r\n  const setScrollPosition = (value: number) => ref[scrollPositionProperty] = value;\r\n  const scrollSize = () => ref[scrollSizeProperty];\r\n  const clientSize = () => ref[clientSizeProperty];\r\n  const offsetSize = () => ref[offsetSizeProperty];\r\n  const getDistanceToEnd = () => scrollSize() - Math.round(scrollPosition() + offsetSize());\r\n\r\n  const onScrollOffset = createMemo(() => props.onScrollOffset ?? 300);\r\n\r\n  let lastScrollDirection: -1 | 0 | 1 = 0;\r\n  let lastScrollPosition = 0;\r\n\r\n  let startMousePosition: number;\r\n  let startScrollPosition: number;\r\n\r\n  let isHeavyAnimationInProgress = false;\r\n  let needCheckAfterAnimation = false;\r\n\r\n  const [isScrolledToStart, setIsScrolledToStart] = createSignal(true);\r\n  const [isScrolledToEnd, setIsScrolledToEnd] = createSignal(true);\r\n\r\n  let onScrollMeasure = 0;\r\n\r\n  const removeHeavyAnimationListener = useHeavyAnimationCheck(() => {\r\n    isHeavyAnimationInProgress = true;\r\n\r\n    if(onScrollMeasure) {\r\n      cancelMeasure();\r\n      needCheckAfterAnimation = true;\r\n    }\r\n  }, () => {\r\n    isHeavyAnimationInProgress = false;\r\n\r\n    if(needCheckAfterAnimation) {\r\n      onScroll();\r\n      needCheckAfterAnimation = false;\r\n    }\r\n  });\r\n\r\n  onCleanup(removeHeavyAnimationListener);\r\n\r\n  const onScroll = () => {\r\n    // if(this.debug) {\r\n    // this.log('onScroll call', this.onScrollMeasure);\r\n    // }\r\n\r\n    // return;\r\n\r\n    if(isHeavyAnimationInProgress) {\r\n      cancelMeasure();\r\n      needCheckAfterAnimation = true;\r\n      return;\r\n    }\r\n\r\n    // if(this.onScrollMeasure || ((this.scrollLocked || (!this.onScrolledTop && !this.onScrolledBottom)) && !this.splitUp && !this.onAdditionalScroll)) return;\r\n    if((!props.onScrolledTop && !props.onScrolledBottom)/*  && !this.splitUp */ && !onScrollCallbacks().length && !USE_OWN_SCROLL) return;\r\n    if(onScrollMeasure) return;\r\n    onScrollMeasure = throttleMeasurement(() => {\r\n      onScrollMeasure = 0;\r\n\r\n      const _scrollPosition = scrollPosition();\r\n      lastScrollDirection = lastScrollPosition === _scrollPosition ? 0 : (lastScrollPosition < _scrollPosition ? 1 : -1); // * 1 - bottom, -1 - top\r\n      lastScrollPosition = _scrollPosition;\r\n\r\n      updateThumb(_scrollPosition);\r\n\r\n      // lastScrollDirection check is useless here, every callback should decide on its own\r\n      if(true/*  && lastScrollDirection !== 0 */) {\r\n        onScrollCallbacks().forEach((callback) => callback());\r\n      }\r\n\r\n      checkForTriggers();\r\n    });\r\n  };\r\n\r\n  const cancelMeasure = () => {\r\n    if(onScrollMeasure) {\r\n      cancelMeasurement(onScrollMeasure);\r\n      onScrollMeasure = 0;\r\n    }\r\n  };\r\n\r\n  const checkForTriggers = () => {\r\n    if(!props.onScrolledTop && !props.onScrolledBottom) return;\r\n\r\n    // if(this.isHeavyAnimationInProgress) {\r\n    //   this.onScroll();\r\n    //   return;\r\n    // }\r\n\r\n    const _scrollSize = scrollSize();\r\n    if(!_scrollSize) { // незачем вызывать триггеры если блок пустой или не виден\r\n      return;\r\n    }\r\n\r\n    const _scrollPosition = scrollPosition();\r\n    const _clientSize = offsetSize();\r\n    const _onScrollOffset = onScrollOffset();\r\n    const maxScrollPosition = _scrollSize - _clientSize;\r\n\r\n    // this.log('checkForTriggers:', scrollTop, maxScrollTop);\r\n\r\n    if(props.onScrolledTop && _scrollPosition <= _onScrollOffset && lastScrollDirection <= 0/* && direction === -1 */) {\r\n      props.onScrolledTop();\r\n    }\r\n\r\n    if(props.onScrolledBottom && (maxScrollPosition - _scrollPosition) <= _onScrollOffset && lastScrollDirection >= 0/* && direction === 1 */) {\r\n      props.onScrolledBottom();\r\n    }\r\n  };\r\n\r\n  const checkEnds = () => {\r\n    setIsScrolledToStart(!scrollPosition());\r\n    setIsScrolledToEnd(getDistanceToEnd() <= 1);\r\n  };\r\n\r\n  const updateThumb = (_scrollPosition = scrollPosition()) => {\r\n    if(!USE_OWN_SCROLL || !thumbRef) {\r\n      return;\r\n    }\r\n\r\n    const _scrollSize = scrollSize();\r\n    const _clientSize = clientSize();\r\n    const divider = _scrollSize / _clientSize / 0.75;\r\n    const thumbSize = Math.max(20, _clientSize / divider);\r\n    const value = _scrollPosition / (_scrollSize - _clientSize) * _clientSize;\r\n    // const b = (scrollPosition + clientSize) / scrollSize;\r\n    const b = _scrollPosition / (_scrollSize - _clientSize);\r\n    const maxValue = _clientSize - thumbSize;\r\n    if(_clientSize < _scrollSize) {\r\n      thumbRef.style.height = thumbSize + 'px';\r\n      // this.thumb.style.top = `${Math.min(maxValue, value - thumbSize * b)}px`;\r\n      thumbRef.style.transform = `translateY(${Math.min(maxValue, value - thumbSize * b)}px)`;\r\n    } else {\r\n      thumbRef.style.height = '0px';\r\n    }\r\n  };\r\n\r\n  const setScrollPositionSilently = (value: number) => {\r\n    lastScrollPosition = value;\r\n    ignoreNextScrollEvent();\r\n\r\n    setScrollPosition(value);\r\n  };\r\n\r\n  const ignoreNextScrollEvent = () => {\r\n    setIgnoreScrollEvent(true);\r\n    ref.addEventListener('scroll', (e) => {\r\n      cancelEvent(e);\r\n      setIgnoreScrollEvent(false);\r\n      // this.addScrollListener();\r\n    }, {capture: true, passive: false, once: true});\r\n  };\r\n\r\n  const onScrollCallbacks = createMemo(() => [props.onScroll, props.withBorders && checkEnds].filter(Boolean));\r\n\r\n  const onThumbMouseMove = (e: MouseEvent) => {\r\n    cancelEvent(e);\r\n\r\n    const contentHeight = scrollSize();\r\n    const viewportHeight = clientSize();\r\n    const scrollbarSize = thumbRef.offsetHeight;\r\n    const maxScrollTop = contentHeight - viewportHeight;\r\n\r\n    const maxScrollbarOffset = viewportHeight - scrollbarSize;\r\n    const deltaY = e[clientAxis] - startMousePosition;\r\n    const scrollAmount = (deltaY / maxScrollbarOffset) * maxScrollTop;\r\n    const newScrollTop = startScrollPosition + scrollAmount;\r\n\r\n    ref[scrollPositionProperty] = newScrollTop;\r\n  };\r\n\r\n  const onThumbMouseDown = (e: MouseEvent) => {\r\n    cancelEvent(e);\r\n    startMousePosition = e[clientAxis];\r\n    startScrollPosition = scrollPosition();\r\n    (e.target as HTMLElement).classList.add('is-focused');\r\n\r\n    window.addEventListener('mousemove', onThumbMouseMove);\r\n    window.addEventListener('mouseup', onThumbMouseUp, {once: true});\r\n  };\r\n\r\n  const onThumbMouseUp = (e: MouseEvent) => {\r\n    window.removeEventListener('mousemove', onThumbMouseMove);\r\n    thumbRef.classList.remove('is-focused');\r\n  };\r\n\r\n  const onWheel = (e: WheelEvent) => {\r\n    e.stopPropagation();\r\n    const target = e.target as HTMLElement;\r\n    if(!e.deltaX && target.scrollWidth > target.clientWidth) {\r\n      target.scrollLeft += e.deltaY / 4;\r\n      cancelEvent(e);\r\n    }\r\n  };\r\n\r\n  const onSizeChange = () => {\r\n    if(USE_OWN_SCROLL && thumbRef) {\r\n      onScroll();\r\n    }\r\n  };\r\n\r\n  const value: ScrollableContextValue = {\r\n    get scrollPosition() {\r\n      return scrollPosition();\r\n    },\r\n    get scrollSize() {\r\n      return scrollSize();\r\n    },\r\n    get clientSize() {\r\n      return clientSize();\r\n    },\r\n    get offsetSize() {\r\n      return offsetSize();\r\n    },\r\n    getDistanceToEnd,\r\n    get container() {\r\n      return ref;\r\n    },\r\n    onSizeChange,\r\n    setScrollPositionSilently\r\n  };\r\n\r\n  const resolvedChildren = children(() => {\r\n    return (\r\n      <ScrollableContext.Provider value={value}>\r\n        {props.children}\r\n      </ScrollableContext.Provider>\r\n    );\r\n  });\r\n\r\n  createEffect(on(resolvedChildren, onSizeChange));\r\n\r\n  let ref: HTMLDivElement, thumbRef: HTMLDivElement;\r\n  return (\r\n    <div\r\n      ref={(_ref) => {\r\n        ref = _ref;\r\n        (props.ref as any)?.(_ref);\r\n      }}\r\n      class={classNames(\r\n        'scrollable',\r\n        `scrollable-${axis}`,\r\n        props.class,\r\n        props.relative && 'relative',\r\n        IS_SAFARI && !IS_MOBILE_SAFARI && 'no-scrollbar',\r\n        ...(props.withBorders ? [\r\n          isScrolledToStart() && 'scrolled-start',\r\n          isScrolledToEnd() && 'scrolled-end',\r\n          axis === 'y' && 'scrollable-y-bordered',\r\n          (props.withBorders === 'top' || props.withBorders === 'both') && 'scrollable-y-bordered-top',\r\n          (props.withBorders === 'bottom' || props.withBorders === 'both') && 'scrollable-y-bordered-bottom'\r\n        ] : [])\r\n      )}\r\n      onScroll={!ignoreScrollEvent() && onScroll}\r\n      onWheel={(axis === 'x' && !IS_TOUCH_SUPPORTED && onWheel) || undefined}\r\n    >\r\n      {USE_OWN_SCROLL && axis === 'y' && (\r\n        <div class=\"scrollable-thumb-container\">\r\n          <div\r\n            class=\"scrollable-thumb\"\r\n            ref={(el) => {\r\n              thumbRef = el;\r\n              props.thumbRef?.(el);\r\n            }}\r\n            onMouseDown={onThumbMouseDown}\r\n          ></div>\r\n        </div>\r\n      )}\r\n      {resolvedChildren()}\r\n    </div>\r\n  );\r\n}\r\n"],"names":["SCROLL_THROTTLE","USE_OWN_SCROLL","IS_OVERLAY_SCROLL_SUPPORTED","throttleMeasurement","cancelMeasurement","callback","requestAnimationFrame","id","cancelAnimationFrame","window","setTimeout","clearTimeout","ScrollableContext","createContext","Scrollable","props","axis","scrollPositionProperty","scrollSizeProperty","clientSizeProperty","offsetSizeProperty","clientAxis","ignoreScrollEvent","setIgnoreScrollEvent","createSignal","scrollPosition","ref","setScrollPosition","value","scrollSize","clientSize","offsetSize","getDistanceToEnd","Math","round","onScrollOffset","createMemo","lastScrollDirection","lastScrollPosition","startMousePosition","startScrollPosition","isHeavyAnimationInProgress","needCheckAfterAnimation","isScrolledToStart","setIsScrolledToStart","isScrolledToEnd","setIsScrolledToEnd","onScrollMeasure","removeHeavyAnimationListener","useHeavyAnimationCheck","cancelMeasure","onScroll","onCleanup","onScrolledTop","onScrolledBottom","onScrollCallbacks","length","_scrollPosition","updateThumb","forEach","checkForTriggers","_scrollSize","_clientSize","_onScrollOffset","maxScrollPosition","checkEnds","thumbRef","divider","thumbSize","max","b","maxValue","style","height","transform","min","setScrollPositionSilently","ignoreNextScrollEvent","addEventListener","e","cancelEvent","capture","passive","once","withBorders","filter","Boolean","onThumbMouseMove","contentHeight","viewportHeight","scrollbarSize","offsetHeight","maxScrollTop","maxScrollbarOffset","scrollAmount","newScrollTop","onThumbMouseDown","target","classList","add","onThumbMouseUp","removeEventListener","remove","onWheel","stopPropagation","deltaX","scrollWidth","clientWidth","scrollLeft","deltaY","onSizeChange","container","resolvedChildren","children","_$createComponent","Provider","createEffect","on","_el$","_tmpl$","_$addEventListener","IS_TOUCH_SUPPORTED","undefined","_$use","_ref","_$insert","_el$2","_tmpl$2","_el$3","firstChild","$$mousedown","el","_$effect","_$className","classNames","class","relative","IS_SAFARI","IS_MOBILE_SAFARI","_$delegateEvents"],"mappings":"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"}