{"version":3,"file":"emailSetup-B7XgbVnq.js","sources":["../src/helpers/solid/subscribeOn.ts","../src/components/codeInputField.tsx","../src/components/rippleElement.tsx","../src/components/buttonTsx.tsx","../src/components/popups/indexTsx.tsx","../src/components/transitionTsx.tsx","../src/components/lottieAnimation.tsx","../src/helpers/solid/classname.tsx","../src/helpers/solid/i18n.tsx","../src/helpers/solid/createListTransition.ts","../src/helpers/solid/animationList.ts","../src/helpers/solid/animations.tsx","../src/components/popups/emailSetup.tsx"],"sourcesContent":["import {onCleanup} from 'solid-js';\r\nimport {ListenerElement} from '../listenerSetter';\r\n\r\nexport function subscribeOn<T extends ListenerElement>(obj: T): T['addEventListener'] {\r\n  return ((event: string, callback: Function, options: any) => {\r\n    // @ts-ignore\r\n    obj.addEventListener(event, callback, options);\r\n\r\n    onCleanup(() => {\r\n      // @ts-ignore\r\n      obj.removeEventListener(event, callback, options);\r\n    });\r\n  }) as any;\r\n}\r\n","/*\r\n * https://github.com/morethanwords/tweb\r\n * Copyright (C) 2019-2021 Eduard Kuzmenko\r\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\r\n */\r\n\r\nimport styles from './codeInputField.module.scss';\r\nimport classNames from '../helpers/string/classNames';\r\nimport {children, createRoot, createSignal, Index, Ref, Show, Signal} from 'solid-js';\r\nimport {subscribeOn} from '../helpers/solid/subscribeOn';\r\nimport {Transition} from '../vendor/solid-transition-group';\r\n\r\nexport default class CodeInputFieldCompat {\r\n  public container: HTMLDivElement;\r\n  public input: HTMLInputElement;\r\n  private dispose: () => void;\r\n  private errorSignal!: Signal<boolean>;\r\n  private disabledSignal!: Signal<boolean>;\r\n  private valueSignal!: Signal<string>;\r\n\r\n  constructor(public options: {\r\n    length: number\r\n    onChange?: (code: string) => void\r\n    onFill?: (code: string) => void\r\n  }) {\r\n    this.errorSignal = createSignal(false);\r\n    this.disabledSignal = createSignal(false);\r\n    this.valueSignal = createSignal('');\r\n    this.container = createRoot((dispose) => {\r\n      this.dispose = dispose;\r\n      const el = (\r\n        <CodeInputField\r\n          {...options}\r\n          ref={this.input}\r\n          error={this.errorSignal[0]()}\r\n          disabled={this.disabledSignal[0]()}\r\n          valueSignal={this.valueSignal}\r\n        />\r\n      );\r\n      return children(() => el)() as HTMLDivElement;\r\n    });\r\n  }\r\n\r\n  set error(value: boolean) {\r\n    this.errorSignal[1](value);\r\n  }\r\n\r\n  set disabled(value: boolean) {\r\n    this.disabledSignal[1](value);\r\n  }\r\n\r\n  set value(value: string) {\r\n    this.valueSignal[1](value);\r\n  }\r\n\r\n  get value() {\r\n    return this.valueSignal[0]();\r\n  }\r\n\r\n  cleanup() {\r\n    this.dispose();\r\n  }\r\n}\r\n\r\nexport function CodeInputField(props: {\r\n  valueSignal?: Signal<string>\r\n  ref?: Ref<HTMLInputElement>\r\n  class?: string\r\n  length: number\r\n  onChange?: (code: string) => void\r\n  onFill?: (code: string) => void\r\n  error?: boolean\r\n  disabled?: boolean\r\n}) {\r\n  const [value, setValue] = props.valueSignal ?? createSignal('');\r\n  const [activeIndexStart, setActiveIndexStart] = createSignal(-1);\r\n  const [activeIndexEnd, setActiveIndexEnd] = createSignal(-1);\r\n  const [isInserting, setIsInserting] = createSignal(false);\r\n\r\n  let isFocused = false;\r\n  let isShiftKeyDown = false;\r\n  const previousSelection = {\r\n    inserting: false as boolean,\r\n    start: null as number | null,\r\n    end: null as number | null\r\n  };\r\n\r\n  const syncSelection = (props: {\r\n    start: number | null\r\n    end: number | null\r\n    inserting: boolean\r\n    originalStart: number | null\r\n    originalEnd: number | null\r\n  }) => {\r\n    previousSelection.inserting = props.inserting\r\n    previousSelection.start = props.originalStart\r\n    previousSelection.end = props.originalEnd\r\n    const start = props.start\r\n    const end = props.end\r\n    if(start === null || end === null) {\r\n      setActiveIndexStart(-1)\r\n      setActiveIndexEnd(-1)\r\n      return\r\n    }\r\n\r\n    setActiveIndexStart(start)\r\n    setActiveIndexEnd(end)\r\n  }\r\n\r\n  const onSelectionChange = (inputType?: string) => {\r\n    if(\r\n      !isFocused ||\r\n      document.activeElement !== inputRef ||\r\n      inputRef.selectionStart === null ||\r\n      inputRef.selectionEnd === null\r\n    ) {\r\n      syncSelection({\r\n        start: null,\r\n        end: null,\r\n        inserting: false,\r\n        originalStart: inputRef.selectionStart,\r\n        originalEnd: inputRef.selectionEnd\r\n      })\r\n      setIsInserting(false)\r\n      return\r\n    }\r\n    const maxLength = props.length\r\n    const inserting =\r\n      inputRef.value.length < maxLength &&\r\n      inputRef.selectionStart === inputRef.value.length\r\n    setIsInserting(inserting)\r\n\r\n    if(inserting || inputRef.selectionStart !== inputRef.selectionEnd) {\r\n      syncSelection({\r\n        start: inputRef.selectionStart,\r\n        end: inserting ? inputRef.selectionEnd + 1 : inputRef.selectionEnd,\r\n        inserting: inserting,\r\n        originalStart: inputRef.selectionStart,\r\n        originalEnd: inputRef.selectionEnd\r\n      })\r\n      return\r\n    }\r\n\r\n    let selectionStart = 0\r\n    let selectionEnd = 0\r\n    let direction: 'forward' | 'backward' | undefined = undefined\r\n    if(inputRef.selectionStart === 0) {\r\n      selectionStart = 0\r\n      selectionEnd = 1\r\n      direction = 'forward'\r\n    } else if(inputRef.selectionStart === maxLength) {\r\n      selectionStart = maxLength - 1\r\n      selectionEnd = maxLength\r\n      direction = 'backward'\r\n    } else {\r\n      let startOffset = 0\r\n      let endOffset = 1\r\n      if(previousSelection.start !== null && previousSelection.end !== null) {\r\n        const navigatedBackwards =\r\n          inputRef.selectionStart < previousSelection.end &&\r\n          Math.abs(previousSelection.start - previousSelection.end) === 1\r\n        direction = navigatedBackwards ? 'backward' : 'forward'\r\n        if(\r\n          (navigatedBackwards &&\r\n            !previousSelection.inserting &&\r\n            inputType !== 'deleteContentForward') ||\r\n          (!navigatedBackwards && isShiftKeyDown)\r\n        ) {\r\n          startOffset += -1\r\n        }\r\n      }\r\n      if(isShiftKeyDown && inputType === undefined) {\r\n        endOffset += 1\r\n      }\r\n      selectionStart = inputRef.selectionStart + startOffset\r\n      selectionEnd = inputRef.selectionEnd + startOffset + endOffset\r\n    }\r\n\r\n    inputRef.setSelectionRange(selectionStart, selectionEnd, direction)\r\n    syncSelection({\r\n      start: selectionStart,\r\n      end: selectionEnd,\r\n      inserting: inserting,\r\n      originalStart: inputRef.selectionStart,\r\n      originalEnd: inputRef.selectionEnd\r\n    })\r\n  }\r\n\r\n  subscribeOn(document)('selectionchange', () => onSelectionChange())\r\n\r\n  let inputRef!: HTMLInputElement;\r\n  return (\r\n    <div\r\n      class={classNames(\r\n        styles.wrap,\r\n        props.error && styles.error,\r\n        props.disabled && styles.disabled,\r\n        props.class\r\n      )}>\r\n      <input\r\n        ref={(el) => {\r\n          inputRef = el;\r\n          (props.ref as any)?.(el);\r\n        }}\r\n        class={styles.input}\r\n        inputmode=\"numeric\"\r\n        autocomplete=\"one-time-code\"\r\n        required\r\n        spellcheck={false}\r\n        pattern=\"^\\d*$\"\r\n        value={value()}\r\n        disabled={props.disabled}\r\n        onFocus={() => {\r\n          inputRef.setSelectionRange(value().length, value().length);\r\n          isFocused = true;\r\n          onSelectionChange()\r\n        }}\r\n        onBlur={() => {\r\n          isFocused = false;\r\n          onSelectionChange()\r\n        }}\r\n        onKeyDown={(e) => {\r\n          if(e.key === 'Shift') {\r\n            isShiftKeyDown = true;\r\n          }\r\n        }}\r\n        onKeyUp={(e) => {\r\n          if(e.key === 'Shift') {\r\n            isShiftKeyDown = false;\r\n          }\r\n        }}\r\n        onInput={(e) => {\r\n          const rawValue = inputRef.value\r\n          let finalValue = rawValue\r\n          const oldValue = value()\r\n          const selectionSize = Math.abs(\r\n            (previousSelection.start ?? 0) - (previousSelection.end ?? 0),\r\n          )\r\n\r\n          if((previousSelection.inserting || selectionSize === oldValue.length)) {\r\n            finalValue = finalValue.replace(/[^\\d]/g, '')\r\n          }\r\n          finalValue = finalValue.slice(0, props.length)\r\n\r\n          const hasInvalidChars = !/^\\d*$/.test(finalValue)\r\n          if(\r\n            (rawValue.length !== 0 && finalValue.length === 0) ||\r\n            finalValue === oldValue ||\r\n            hasInvalidChars\r\n          ) {\r\n            e.preventDefault()\r\n            e.currentTarget.value = oldValue\r\n            if(hasInvalidChars) {\r\n              e.currentTarget.setSelectionRange(\r\n                previousSelection.start ?? 0,\r\n                previousSelection.end ?? 0,\r\n              )\r\n            }\r\n            return\r\n          }\r\n\r\n          if(finalValue.length < oldValue.length) {\r\n            onSelectionChange(e.inputType)\r\n          }\r\n\r\n          setValue(finalValue)\r\n\r\n          props.onChange?.(finalValue)\r\n          if(finalValue.length === props.length) {\r\n            props.onFill?.(finalValue)\r\n          }\r\n        }}\r\n      />\r\n\r\n      <Index each={Array.from({length: props.length})}>\r\n        {(_, idx) => (\r\n          <div\r\n            class={classNames(\r\n              styles.digit,\r\n              (activeIndexStart() <= idx && idx < activeIndexEnd()) && styles.active\r\n            )}\r\n          >\r\n            <Transition>\r\n              <Show when={value()[idx]}>\r\n                <div class={styles.digitContent}>\r\n                  {value()[idx]}\r\n                </div>\r\n              </Show>\r\n            </Transition>\r\n            {isInserting() && value().length === idx && <div class={styles.caret} />}\r\n          </div>\r\n        )}\r\n      </Index>\r\n    </div>\r\n  )\r\n}\r\n","import {createRenderEffect, createSignal, onCleanup, Ref, splitProps, ValidComponent} from 'solid-js';\r\nimport {Dynamic, DynamicProps} from 'solid-js/web';\r\nimport ripple from './ripple';\r\nimport classNames from '../helpers/string/classNames';\r\nripple; // keep\r\n\r\nexport default function RippleElement<T extends ValidComponent>(props: DynamicProps<T> & {noRipple?: boolean, rippleSquare?: boolean}) {\r\n  const [, rest] = splitProps(props, ['noRipple', 'rippleSquare']);\r\n  const [rippleElement, setRippleElement] = createSignal<HTMLElement>();\r\n  return (\r\n    <Dynamic\r\n      {...rest as typeof props}\r\n      ref={(ref: any) => {\r\n        createRenderEffect(() => {\r\n          if(!props.noRipple) {\r\n            const ret = ripple(ref, undefined, 'no');\r\n            setRippleElement(ret.element);\r\n            onCleanup(() => {\r\n              ret.dispose();\r\n              setRippleElement();\r\n            });\r\n          }\r\n        });\r\n\r\n        (props.ref as Ref<any>)?.(ref);\r\n      }}\r\n      class={classNames(\r\n        props.class,\r\n        !props.noRipple && 'rp',\r\n        !props.noRipple && props.rippleSquare && 'rp-square',\r\n        ...Object.entries(props.classList || {}).map(([key, value]) => value ? key : undefined)\r\n      )}\r\n    >\r\n      {rippleElement()}\r\n      {props.children}\r\n    </Dynamic>\r\n  );\r\n}\r\n","import {Accessor, createMemo, createSignal, JSX, Ref, Setter} from 'solid-js';\r\nimport {FormatterArguments, i18n, LangPackKey} from '../lib/langPack';\r\nimport {IconTsx} from './iconTsx';\r\nimport classNames from '../helpers/string/classNames';\r\nimport RippleElement from './rippleElement';\r\n\r\nconst Button = (props: Partial<{\r\n  ref: Ref<HTMLElement>,\r\n  as: 'a' | 'div' | 'button',\r\n  class: string,\r\n  disabled: boolean,\r\n  primaryFilled: boolean,\r\n  primary: boolean,\r\n  primaryTransparent: boolean,\r\n  large: boolean,\r\n  children: JSX.Element,\r\n  icon: Icon,\r\n  iconAfter: Icon,\r\n  iconClass: string,\r\n  onClick: (e: MouseEvent) => any,\r\n  text: LangPackKey,\r\n  textArgs: FormatterArguments,\r\n  noRipple: boolean,\r\n  rippleSquare: boolean,\r\n  onlyMobile: boolean\r\n  tabIndex: number,\r\n}> = {}): JSX.Element => {\r\n  let disabled: Accessor<boolean>, setDisabled: Setter<boolean>;\r\n  if(props.disabled !== undefined) {\r\n    disabled = createMemo(() => props.disabled);\r\n  } else {\r\n    [disabled, setDisabled] = createSignal(false);\r\n  }\r\n\r\n  return (\r\n    <RippleElement\r\n      ref={props.ref as Ref<any>}\r\n      component={props.as || 'button'}\r\n      class={classNames(\r\n        props.class,\r\n        props.primaryFilled && 'btn-primary btn-color-primary',\r\n        props.primary && 'btn btn-primary primary',\r\n        props.primaryTransparent && 'btn-primary primary btn-transparent',\r\n        props.large && 'btn-large',\r\n        props.onlyMobile && 'only-handhelds'\r\n      )}\r\n      disabled={disabled()}\r\n      onClick={props.onClick && setDisabled ? ((e: any) => {\r\n        try {\r\n          const result = props.onClick(e);\r\n          if(result instanceof Promise) {\r\n            setDisabled(true);\r\n            result.finally(() => {\r\n              setDisabled(false);\r\n            });\r\n          }\r\n        } catch(err) {\r\n          throw err;\r\n        }\r\n      }) : props.onClick}\r\n      noRipple={props.noRipple}\r\n      rippleSquare={props.rippleSquare}\r\n      tabIndex={props.tabIndex}\r\n    >\r\n      {props.icon && <IconTsx icon={props.icon} class={classNames('button-icon', props.iconClass)} />}\r\n      {props.text ? i18n(props.text, props.textArgs) : props.children}\r\n      {props.iconAfter && <IconTsx icon={props.iconAfter} class={classNames('button-icon', props.iconClass)} />}\r\n    </RippleElement>\r\n  );\r\n};\r\n\r\nButton.Corner = (props: Partial<{\r\n  ref: Ref<HTMLElement>,\r\n  children: JSX.Element,\r\n  onClick: (e: MouseEvent) => void,\r\n  class: string\r\n}>) => {\r\n  return (\r\n    <Button {...props} class={classNames('btn-circle', 'btn-corner', 'z-depth-1', props.class)} tabIndex={-1} />\r\n  );\r\n};\r\n\r\nButton.Icon = (props: {icon: Icon} & Partial<{\r\n  ref: Ref<HTMLElement>,\r\n  children: JSX.Element,\r\n  onClick: (e: MouseEvent) => void,\r\n  class: string\r\n}>) => {\r\n  return (\r\n    <Button {...props} class={classNames('btn-icon', props.icon, props.class)} tabIndex={-1} />\r\n  )\r\n};\r\n\r\nexport default Button;\r\n","/*\r\n * https://github.com/morethanwords/tweb\r\n * Copyright (C) 2019-2021 Eduard Kuzmenko\r\n * https://github.com/morethanwords/tweb/blob/master/LICENSE\r\n */\r\n\r\nimport {createContext, useContext, createSignal, onCleanup, JSX, Show, children, createRoot, Accessor, createEffect, untrack, on} from 'solid-js';\r\nimport {createStore} from 'solid-js/store';\r\nimport {Portal} from 'solid-js/web';\r\nimport classNames from '../../helpers/string/classNames';\r\nimport {IconTsx} from '../iconTsx';\r\nimport RippleElement from '../rippleElement';\r\nimport {FormatterArguments, i18n, LangPackKey} from '../../lib/langPack';\r\nimport {AppManagers} from '../../lib/appManagers/managers';\r\nimport overlayCounter from '../../helpers/overlayCounter';\r\nimport {getMiddleware, MiddlewareHelper} from '../../helpers/middleware';\r\nimport findUpClassName from '../../helpers/dom/findUpClassName';\r\nimport blurActiveElement from '../../helpers/dom/blurActiveElement';\r\nimport animationIntersector from '../animationIntersector';\r\nimport appNavigationController, {NavigationItem} from '../appNavigationController';\r\nimport {addFullScreenListener, getFullScreenElement} from '../../helpers/dom/fullScreen';\r\nimport indexOfAndSplice from '../../helpers/array/indexOfAndSplice';\r\nimport MarkupTooltip from '../chat/markupTooltip';\r\nimport Button from '../buttonTsx';\r\n\r\nexport type PopupButton = {\r\n  text?: HTMLElement | DocumentFragment | Text,\r\n  callback?: (e: MouseEvent) => MaybePromise<boolean | void>,\r\n  langKey?: LangPackKey,\r\n  langArgs?: any[],\r\n  isDanger?: boolean,\r\n  isCancel?: boolean,\r\n  element?: HTMLButtonElement,\r\n  noRipple?: boolean,\r\n  iconLeft?: Icon,\r\n  iconRight?: Icon\r\n};\r\n\r\nexport type PopupOptions = Partial<{\r\n  closable: boolean,\r\n  onBackClick: () => void | false,\r\n  onClose: () => void,\r\n  onCloseAfterTimeout: () => void,\r\n  isConfirmationNeededOnClose: () => void | boolean | Promise<any>,\r\n  // overlayClosable: boolean,\r\n  withConfirm: LangPackKey | boolean,\r\n  body: boolean,\r\n  footer: boolean,\r\n  confirmShortcutIsSendShortcut: boolean,\r\n  withoutOverlay: boolean,\r\n  scrollable: boolean,\r\n  buttons: Array<PopupButton>,\r\n  title: boolean | LangPackKey | DocumentFragment | HTMLElement,\r\n  floatingHeader: boolean,\r\n  withFooterConfirm: boolean\r\n}>;\r\n\r\ntype PopupKind = 'header' | 'title' | 'body' | 'footer' | 'buttons' | 'closeButton' | 'confirmButton';\r\n\r\ntype PopupContextValue = {\r\n  register: (kind: PopupKind, element: JSX.Element) => JSX.Element,\r\n  registerButton: (props: PopupButton, element: JSX.Element) => JSX.Element,\r\n  store: {[key in PopupKind]?: JSX.Element},\r\n  buttons: PopupButton[],\r\n  shown: () => boolean,\r\n  show: () => void,\r\n  hide: () => void,\r\n  destroy: () => void,\r\n  destroyed: boolean,\r\n  managers: AppManagers,\r\n  middlewareHelper: MiddlewareHelper,\r\n  lateMiddlewareHelper: MiddlewareHelper,\r\n  navigationItem: NavigationItem | undefined,\r\n  // scrollable: Scrollable | undefined,\r\n  withoutOverlay: boolean,\r\n  night: boolean,\r\n  confirmShortcutIsSendShortcut: boolean,\r\n  // btnConfirmOnEnter: HTMLElement | undefined,\r\n  isConfirmationNeededOnClose: PopupOptions['isConfirmationNeededOnClose'],\r\n  closable: boolean,\r\n  withConfirm: LangPackKey | boolean,\r\n  body: boolean,\r\n  footer: boolean,\r\n  title: boolean | LangPackKey | DocumentFragment | HTMLElement,\r\n  element: HTMLElement | undefined\r\n};\r\n\r\ntype PopupControllerContextValue = {\r\n  dispose: () => void\r\n};\r\n\r\nconst PopupContext = createContext<PopupContextValue>();\r\nconst PopupControllerContext = createContext<PopupControllerContextValue>();\r\n\r\nconst DEFAULT_APPEND_TO = document.body;\r\nconst [appendPopupTo, setAppendPopupTo] = createSignal(DEFAULT_APPEND_TO);\r\n\r\nconst onFullScreenChange = () => {\r\n  setAppendPopupTo(getFullScreenElement() || DEFAULT_APPEND_TO);\r\n};\r\n\r\naddFullScreenListener(DEFAULT_APPEND_TO, onFullScreenChange);\r\n\r\nconst PopupElement = (props: {\r\n  class?: string,\r\n  containerClass?: string,\r\n  managers?: AppManagers,\r\n  children: JSX.Element,\r\n  show?: boolean\r\n} & PopupOptions) => {\r\n  const [shown, setShown] = createSignal(false);\r\n  const [store, setStore] = createStore<PopupContextValue['store']>({});\r\n  const [buttons, setButtons] = createStore<PopupButton[]>([]);\r\n  const [navigationItem, setNavigationItem] = createSignal<NavigationItem | undefined>();\r\n  const controllerContext = useContext(PopupControllerContext);\r\n\r\n  const managers = props.managers || PopupElement.MANAGERS;\r\n  const middlewareHelper = getMiddleware();\r\n  const lateMiddlewareHelper = getMiddleware();\r\n  const withoutOverlay = props.withoutOverlay || false;\r\n  const night = overlayCounter.isDarkOverlayActive;\r\n  const confirmShortcutIsSendShortcut = props.confirmShortcutIsSendShortcut || false;\r\n  const isConfirmationNeededOnClose = props.isConfirmationNeededOnClose;\r\n\r\n  const register = (kind: PopupKind, element: JSX.Element) => {\r\n    setStore(kind, element);\r\n    onCleanup(() => setStore(kind, undefined));\r\n    return element;\r\n  };\r\n\r\n  const registerButton = (props: PopupButton, element: JSX.Element) => {\r\n    setButtons([...buttons, props]);\r\n    onCleanup(() => setButtons(buttons.filter((b) => b !== props)));\r\n    return element;\r\n  };\r\n\r\n  const show = () => {\r\n    if(shown() || destroyed()) return;\r\n\r\n    setShown(true);\r\n    const navItem: NavigationItem = {\r\n      type: 'popup',\r\n      onPop: () => {\r\n        if(isConfirmationNeededOnClose) {\r\n          const result = isConfirmationNeededOnClose();\r\n          if(result) {\r\n            Promise.resolve(result).then(() => {\r\n              destroy();\r\n            });\r\n            return false;\r\n          }\r\n        }\r\n        return destroy();\r\n      }\r\n    };\r\n    setNavigationItem(navItem);\r\n    appNavigationController.pushItem(navItem);\r\n\r\n    blurActiveElement();\r\n\r\n    if(!withoutOverlay) {\r\n      overlayCounter.isOverlayActive = true;\r\n      animationIntersector.checkAnimations2(true);\r\n    }\r\n\r\n    // Add keyboard event listener\r\n    // setTimeout(() => {\r\n    //   const element = popupElement();\r\n    //   if(!element || !element.classList.contains('active')) return;\r\n\r\n    //   const handleKeydown = (e: KeyboardEvent) => {\r\n    //     const btnConfirm = btnConfirmOnEnter();\r\n    //     if(!btnConfirm ||\r\n    //        (btnConfirm as HTMLButtonElement).disabled ||\r\n    //        PopupElementTsx.POPUPS[PopupElementTsx.POPUPS.length - 1] !== value) {\r\n    //       return;\r\n    //     }\r\n\r\n    //     if(confirmShortcutIsSendShortcut ? isSendShortcutPressed(e) : e.key === 'Enter') {\r\n    //       simulateClickEvent(btnConfirm);\r\n    //       cancelEvent(e);\r\n    //     }\r\n    //   };\r\n\r\n    //   document.body.addEventListener('keydown', handleKeydown);\r\n    //   onCleanup(() => document.body.removeEventListener('keydown', handleKeydown));\r\n    // }, 0);\r\n  };\r\n\r\n  const hide = () => {\r\n    if(destroyed()) return;\r\n\r\n    const navItem = navigationItem();\r\n    if(!navItem) {\r\n      destroy();\r\n      return;\r\n    }\r\n\r\n    appNavigationController.backByItem(navItem);\r\n  };\r\n\r\n  const destroy = () => {\r\n    if(destroyed()) return;\r\n\r\n    props.onClose?.()\r\n\r\n    setHiding(true);\r\n    setDestroyed(true);\r\n    setShown(false);\r\n\r\n    setTimeout(() => {\r\n      setHiding(false);\r\n      middlewareHelper.destroy();\r\n      MarkupTooltip.getInstance().hide();\r\n\r\n      if(!withoutOverlay) {\r\n        overlayCounter.isOverlayActive = false;\r\n      }\r\n\r\n      const navItem = navigationItem();\r\n      if(navItem) {\r\n        appNavigationController.removeItem(navItem);\r\n        setNavigationItem(undefined);\r\n      }\r\n\r\n      indexOfAndSplice(PopupElement.POPUPS, value);\r\n\r\n      onFullScreenChange();\r\n\r\n      lateMiddlewareHelper.destroy();\r\n\r\n      if(!withoutOverlay) {\r\n        animationIntersector.checkAnimations2(false);\r\n      }\r\n\r\n      controllerContext.dispose();\r\n      props.onCloseAfterTimeout?.();\r\n    }, 250);\r\n  };\r\n\r\n  const [destroyed, setDestroyed] = createSignal(false);\r\n  const [hiding, setHiding] = createSignal(false);\r\n  const [popupElement, setPopupElement] = createSignal<HTMLElement>();\r\n\r\n  const value: PopupContextValue = {\r\n    register,\r\n    registerButton,\r\n    store,\r\n    buttons,\r\n    shown,\r\n    show,\r\n    hide,\r\n    destroy,\r\n    get destroyed() { return destroyed(); },\r\n    managers,\r\n    middlewareHelper,\r\n    lateMiddlewareHelper,\r\n    get navigationItem() { return navigationItem(); },\r\n    // get scrollable() { return scrollable(); },\r\n    withoutOverlay,\r\n    night,\r\n    confirmShortcutIsSendShortcut,\r\n    // get btnConfirmOnEnter() { return btnConfirmOnEnter(); },\r\n    isConfirmationNeededOnClose,\r\n    closable: props.closable || false,\r\n    withConfirm: props.withConfirm || false,\r\n    body: props.body || false,\r\n    footer: props.footer || false,\r\n    title: props.title || false,\r\n    get element() { return popupElement(); }\r\n  };\r\n\r\n  // Add to popups array\r\n  PopupElement.POPUPS.push(value);\r\n  onCleanup(() => {\r\n    indexOfAndSplice(PopupElement.POPUPS, value);\r\n  });\r\n\r\n  if(props.show !== undefined) {\r\n    createEffect(on(() => props.show, (_show) => {\r\n      if(_show) {\r\n        show();\r\n      } else if(shown()) {\r\n        hide();\r\n      }\r\n    }));\r\n  } else {\r\n    setTimeout(() => {\r\n      show();\r\n    }, 0);\r\n  }\r\n\r\n  return (\r\n    <PopupContext.Provider value={value}>\r\n      <Portal mount={appendPopupTo()}>\r\n        <div\r\n          ref={setPopupElement}\r\n          class={classNames(\r\n            'popup',\r\n            props.class,\r\n            night && 'night',\r\n            withoutOverlay && 'no-overlay',\r\n            shown() && 'active',\r\n            hiding() && 'hiding'\r\n          )}\r\n          onClick={/* store.closeButton &&  */((e) => {\r\n            if(findUpClassName(e.target, 'popup-container') || !(e.target as HTMLElement).isConnected) {\r\n              return;\r\n            }\r\n\r\n            if(props.closable === false) return\r\n\r\n            hide();\r\n          })}\r\n        >\r\n          <div class={classNames('popup-container z-depth-1', props.containerClass)}>\r\n            {props.children}\r\n          </div>\r\n        </div>\r\n      </Portal>\r\n    </PopupContext.Provider>\r\n  );\r\n};\r\n\r\n// Static properties\r\nPopupElement.POPUPS = [] as any[];\r\nPopupElement.MANAGERS = undefined as any;\r\n\r\nPopupElement.Header = (props: {\r\n  class?: string,\r\n  children?: JSX.Element\r\n}) => {\r\n  return useContext(PopupContext).register('header', (\r\n    <div class={classNames('popup-header', props.class)}>\r\n      {props.children}\r\n    </div>\r\n  ));\r\n};\r\n\r\nPopupElement.Title = (props: {\r\n  children?: JSX.Element,\r\n  title?: boolean | LangPackKey | DocumentFragment | HTMLElement\r\n}) => {\r\n  const context = useContext(PopupContext);\r\n  const titleContent = () => {\r\n    if(props.title) {\r\n      if(typeof(props.title) === 'string') {\r\n        return i18n(props.title);\r\n      } else if(typeof(props.title) !== 'boolean') {\r\n        return props.title;\r\n      }\r\n    }\r\n    return props.children;\r\n  };\r\n\r\n  return context.register('title', (\r\n    <Show when={titleContent()}>\r\n      <div class=\"popup-title\">\r\n        {titleContent()}\r\n      </div>\r\n    </Show>\r\n  ));\r\n};\r\n\r\nPopupElement.CloseButton = (props: {\r\n  canGoBack?: boolean,\r\n  onBackClick?: () => void | false\r\n  class?: string\r\n}) => {\r\n  const context = useContext(PopupContext);\r\n\r\n  const handleClick = () => {\r\n    if(props.canGoBack && props.onBackClick) {\r\n      props.onBackClick()\r\n    } else {\r\n      context.hide();\r\n    }\r\n  };\r\n\r\n  return context.register('closeButton', (\r\n    <button\r\n      class={classNames('btn-icon popup-close', props.class)}\r\n      onClick={handleClick}\r\n    >\r\n      <Show when={props.onBackClick} fallback={<IconTsx icon=\"close\" />}>\r\n        <div class={classNames('animated-close-icon', props.canGoBack && 'state-back')} />\r\n      </Show>\r\n    </button>\r\n  ));\r\n};\r\n\r\nPopupElement.ConfirmButton = (props: {\r\n  withConfirm?: LangPackKey | boolean\r\n}) => {\r\n  const context = useContext(PopupContext);\r\n\r\n  if(!context.withConfirm) return null;\r\n\r\n  return context.register('confirmButton', (\r\n    <button class=\"btn-primary btn-color-primary\">\r\n      <Show when={context.withConfirm !== true}>\r\n        {i18n(context.withConfirm as LangPackKey)}\r\n      </Show>\r\n    </button>\r\n  ));\r\n};\r\n\r\nPopupElement.Body = (props: {\r\n  children: JSX.Element,\r\n  class?: string,\r\n  scrollable?: boolean,\r\n  floatingHeader?: boolean\r\n}) => {\r\n  return useContext(PopupContext).register('body', (\r\n    <div class={classNames('popup-body', props.class)}>\r\n      {props.children}\r\n    </div>\r\n  ));\r\n};\r\n\r\nPopupElement.Footer = (props: {\r\n  children: JSX.Element,\r\n  class?: string\r\n}) => {\r\n  return useContext(PopupContext).register('footer', (\r\n    <div class={classNames('popup-footer popup-footer-abitlarger', props.class)}>\r\n      {props.children}\r\n    </div>\r\n  ));\r\n};\r\n\r\nPopupElement.FooterButton = (props: Parameters<typeof PopupElement.Button>[0] & {secondary?: boolean}) => {\r\n  return (\r\n    <PopupElement.Button\r\n      {...props}\r\n      noDefaultClass\r\n      class={classNames(\r\n        'popup-footer-button',\r\n        'btn-primary',\r\n        props.secondary ? 'btn-transparent primary text-bold' : 'btn-color-primary',\r\n        props.class\r\n      )}\r\n    />\r\n  );\r\n};\r\n\r\nPopupElement.Button = (props: {\r\n  children?: JSX.Element,\r\n  callback?: (e: MouseEvent) => MaybePromise<boolean | void>,\r\n  langKey?: LangPackKey,\r\n  langArgs?: FormatterArguments,\r\n  danger?: boolean,\r\n  cancel?: boolean,\r\n  noRipple?: boolean,\r\n  iconLeft?: Icon,\r\n  iconRight?: Icon,\r\n  class?: string,\r\n  noDefaultClass?: boolean,\r\n  disabled?: boolean\r\n}) => {\r\n  const context = useContext(PopupContext);\r\n\r\n  const [disabled, setDisabled] = createSignal(false);\r\n\r\n  const handleClick = async(e: MouseEvent) => {\r\n    if(context.destroyed) return;\r\n    let result = props.callback?.(e);\r\n    if(result !== undefined && result instanceof Promise) {\r\n      setDisabled(true);\r\n      try {\r\n        result = await result;\r\n      } catch(err) {\r\n        console.log('popup button error', err);\r\n        result = false;\r\n      }\r\n\r\n      if(result === false) {\r\n        setDisabled(false);\r\n      }\r\n    }\r\n\r\n    if(result === false) {\r\n      return;\r\n    }\r\n\r\n    context.hide();\r\n  };\r\n\r\n  return context.registerButton(props, (\r\n    <Button\r\n      class={classNames(\r\n        !props.noDefaultClass && 'popup-button btn',\r\n        props.noDefaultClass ? undefined : (props.danger ? 'danger' : 'primary'),\r\n        props.class\r\n      )}\r\n      noRipple={props.noRipple}\r\n      onClick={handleClick}\r\n      disabled={props.disabled || disabled()}\r\n      icon={props.iconLeft}\r\n      iconAfter={props.iconRight}\r\n      iconClass={classNames('popup-button-icon', props.iconLeft ? 'left' : 'right')}\r\n      text={props.langKey}\r\n      textArgs={props.langArgs}\r\n    >{props.children}</Button>\r\n  ));\r\n};\r\n\r\nPopupElement.Buttons = (props: {\r\n  children?: JSX.Element\r\n}) => {\r\n  const context = useContext(PopupContext);\r\n  return context.register('buttons', (\r\n    <div class=\"popup-buttons\">\r\n      {props.children}\r\n    </div>\r\n  ));\r\n};\r\n\r\nPopupElement.getPopups = <T extends any>(popupConstructor: any) => {\r\n  return PopupElement.POPUPS.filter((element) => element instanceof popupConstructor) as T[];\r\n};\r\n\r\nexport const addCancelButton = (buttons: PopupButton[]) => {\r\n  const button = buttons.find((b) => b.isCancel);\r\n  if(!button) {\r\n    buttons.push({\r\n      langKey: 'Cancel',\r\n      isCancel: true\r\n    });\r\n  }\r\n\r\n  return buttons;\r\n};\r\n\r\nexport function createPopup(callback: () => JSX.Element) {\r\n  createRoot((dispose) => {\r\n    <PopupControllerContext.Provider value={{dispose}}>\r\n      {untrack(callback)}\r\n    </PopupControllerContext.Provider>\r\n  });\r\n}\r\n\r\nexport default PopupElement;\r\n\r\n/*\r\nПример использования PopupElementTsx:\r\n\r\nimport PopupElementTsx from './indexTsx';\r\n\r\n// Простой попап с заголовком и кнопками (чистый JSX)\r\n<PopupElementTsx\r\n  class=\"my-popup\"\r\n  closable={true}\r\n  overlayClosable={true}\r\n  title=\"MyPopupTitle\"\r\n  body={true}\r\n>\r\n  <PopupElementTsx.CloseButton />\r\n  <PopupElementTsx.Title />\r\n  <PopupElementTsx.Body>\r\n    <div>Содержимое попапа</div>\r\n  </PopupElementTsx.Body>\r\n  <PopupElementTsx.Buttons>\r\n    <PopupElementTsx.Button\r\n      langKey=\"Cancel\"\r\n      isCancel={true}\r\n    />\r\n    <PopupElementTsx.Button\r\n      langKey=\"OK\"\r\n      callback={() => {\r\n        console.log('OK clicked');\r\n        return true; // закрыть попап\r\n      }}\r\n    />\r\n  </PopupElementTsx.Buttons>\r\n</PopupElementTsx>\r\n\r\n// Теперь весь попап полностью реактивный без ручных DOM манипуляций!\r\n// - JSX с Portal для монтирования\r\n// - Сигналы для всех состояний (shown, hiding, disabled, backState)\r\n// - Реактивные классы вместо classList манипуляций\r\n// - Автоматическое переключение fullscreen через appendPopupTo сигнал\r\n// - Никаких createElement, dispatchEvent, classList.add/remove\r\n*/\r\n","import {createEffect, For, JSX, on, onMount, splitProps} from 'solid-js';\r\nimport TransitionSlider, {TransitionSliderOptions} from './transition';\r\nimport classNames from '../helpers/string/classNames';\r\n\r\nexport function TransitionSliderTsx(props: Omit<TransitionSliderOptions, 'content'> & {\r\n  children: JSX.Element[]\r\n  currentPage: number\r\n  class?: string\r\n  tabClass?: string\r\n}) {\r\n  const [, rest] = splitProps(props, ['children', 'currentPage', 'class', 'tabClass']);\r\n\r\n  let ref!: HTMLDivElement;\r\n  onMount(() => {\r\n    const transitionTo = TransitionSlider({\r\n      ...rest,\r\n      content: ref\r\n    });\r\n\r\n    createEffect(on(() => props.currentPage, (currentPage) => transitionTo(currentPage)));\r\n  })\r\n\r\n  return (\r\n    <div class={classNames('tabs-container', props.class)} ref={ref}>\r\n      <For each={props.children}>\r\n        {(child) => (\r\n          <div class={classNames('tabs-tab', props.tabClass)}>\r\n            {child}\r\n          </div>\r\n        )}\r\n      </For>\r\n    </div>\r\n  )\r\n}\r\n","import {Component, createRenderEffect, mergeProps, onCleanup, onMount} from 'solid-js';\r\n\r\nimport type {LottieAssetName, LottieLoader} from '../lib/rlottie/lottieLoader';\r\nimport RLottiePlayer, {RLottieOptions} from '../lib/rlottie/rlottiePlayer';\r\n\r\nconst LottieAnimation: Component<{\r\n  lottieLoader: LottieLoader;\r\n  class?: string;\r\n  name: LottieAssetName;\r\n  size?: number;\r\n  needRaf?: boolean;\r\n  restartOnClick?: boolean;\r\n  rlottieOptions?: Partial<RLottieOptions>\r\n  onPromise?: (promise: Promise<RLottiePlayer>) => void;\r\n}> = (inProps) => {\r\n  const props = mergeProps({size: 100}, inProps);\r\n\r\n  let animationPromise: Promise<RLottiePlayer>;\r\n\r\n  const div = (\r\n    <div\r\n      classList={{\r\n        [props.class]: !!props.class\r\n      }}\r\n      style={{\r\n        '--size': props.size + 'px'\r\n      }}\r\n      onClick={() => {\r\n        if(!props.restartOnClick) return;\r\n        animationPromise?.then((animation) => {\r\n          animation.playOrRestart();\r\n        });\r\n      }}\r\n    />\r\n  ) as HTMLDivElement;\r\n\r\n  let cleanup = false\r\n  function loadAnimation() {\r\n    if(props.needRaf && !div.isConnected && !cleanup) {\r\n      requestAnimationFrame(loadAnimation);\r\n      return\r\n    }\r\n\r\n    animationPromise = props.lottieLoader.loadAnimationAsAsset(\r\n      {\r\n        container: div,\r\n        loop: false,\r\n        autoplay: true,\r\n        width: props.size,\r\n        height: props.size,\r\n        ...props.rlottieOptions\r\n      },\r\n      props.name\r\n    );\r\n    props.onPromise?.(animationPromise);\r\n  }\r\n\r\n  createRenderEffect(loadAnimation);\r\n\r\n  onCleanup(() => {\r\n    cleanup = true;\r\n    animationPromise?.then((animation) => {\r\n      animation.remove();\r\n    });\r\n  });\r\n\r\n\r\n  return div;\r\n}\r\n\r\nexport default LottieAnimation;\r\n","import {createEffect, on, onCleanup} from 'solid-js';\r\n\r\nexport function attachClassName(element: HTMLElement, accessor: () => string) {\r\n  createEffect(on(accessor, (value, prev) => {\r\n    if(prev) {\r\n      element.classList.remove(...prev.split(' '));\r\n    }\r\n    if(value) {\r\n      element.classList.add(...value.split(' '));\r\n    }\r\n  }));\r\n}\r\n\r\nexport function attachHotClassName(element: HTMLElement, ...className: string[]) {\r\n  element.classList.add(...className);\r\n  if(import.meta.hot) onCleanup(() => void element.classList.remove(...className));\r\n}\r\n","import {Accessor, createEffect, createMemo, JSX, on} from 'solid-js';\r\nimport I18n, {FormatterArgument, FormatterArguments, LangPackKey} from '../../lib/langPack';\r\nimport {attachClassName} from './classname';\r\nimport {resolveElements} from '@solid-primitives/refs';\r\n\r\nexport function I18nTsx(props: {\r\n  key: LangPackKey,\r\n  class?: string,\r\n  args?: JSX.Element | (JSX.Element | FormatterArgument)[],\r\n}) {\r\n  const argsEls = resolveElements(() => props.args, it => it instanceof Node || typeof it === 'string');\r\n  const args: Accessor<FormatterArguments> = () => argsEls.toArray()\r\n\r\n  const el = new I18n.IntlElement({\r\n    key: props.key,\r\n    args: args()\r\n  })\r\n\r\n  attachClassName(el.element, () => props.class);\r\n\r\n  createEffect(on(() => [props.key, args()] as const, ([key, args], _prev) => {\r\n    el.update({key, args});\r\n  }, {defer: true}))\r\n\r\n  return el.element;\r\n}\r\n","import type {ListTransitionOptions} from '@solid-primitives/transition-group';\r\nimport {Modify} from '../../types';\r\nimport {createSignal, useTransition, $TRACK, createMemo, Accessor, untrack} from 'solid-js';\r\nimport {isServer} from 'solid-js/web';\r\nimport noop from '../noop';\r\n\r\nexport function createListTransition<T extends object>(\r\n  source: Accessor<readonly T[]>,\r\n  options: Modify<ListTransitionOptions<T>, {exitMethod?: ListTransitionOptions<T>['exitMethod'] | 'keep-relative'}>\r\n): Accessor<T[]> {\r\n  const initSource = untrack(source);\r\n\r\n  if(isServer) {\r\n    const copy = initSource.slice();\r\n    return () => copy;\r\n  }\r\n\r\n  const {onChange} = options;\r\n\r\n  // if appear is enabled, the initial transition won't have any previous elements.\r\n  // otherwise the elements will match and transition skipped, or transitioned if the source is different from the initial value\r\n  let prevSet: ReadonlySet<T> = new Set(options.appear ? undefined : initSource);\r\n  const exiting = new WeakSet<T>();\r\n\r\n  const [toRemove, setToRemove] = createSignal<T[]>([], {equals: false});\r\n  const [isTransitionPending] = useTransition();\r\n\r\n  const finishRemoved: (els: T[]) => void =\r\n    options.exitMethod === 'remove' ?\r\n      noop :\r\n      (els) => {\r\n        setToRemove((p) => (p.push(...els), p));\r\n        for(const el of els) exiting.delete(el);\r\n      };\r\n\r\n  type RemovedOptions = {\r\n    elements: T[],\r\n    element: T,\r\n    previousElements: T[],\r\n    previousIndex: number,\r\n    side: 'start' | 'end'\r\n  };\r\n\r\n  let handleRemoved: (options: RemovedOptions) => void;\r\n  if(options.exitMethod === 'remove') {\r\n    handleRemoved = noop;\r\n  } else if(options.exitMethod === 'keep-index') {\r\n    handleRemoved = (options) => options.elements.splice(options.previousIndex, 0, options.element);\r\n  } else if(options.exitMethod === 'keep-relative') {\r\n    handleRemoved = (options) => {\r\n      let index: number;\r\n      if(options.side === 'start') {\r\n        index = options.previousIndex;\r\n      } else {\r\n        // index = options.elements.length - (options.previousElements.length - 1 - options.previousIndex);\r\n        index = options.elements.length;\r\n      }\r\n\r\n      options.elements.splice(index, 0, options.element);\r\n    };\r\n  } else {\r\n    handleRemoved = (options) => options.elements.push(options.element);\r\n  }\r\n\r\n  const compute = (prev: T[]) => {\r\n    const elsToRemove = toRemove();\r\n    const sourceList = source();\r\n    (sourceList as any)[$TRACK]; // top level store tracking\r\n\r\n    if(untrack(isTransitionPending)) {\r\n      // wait for pending transition to end before animating\r\n      isTransitionPending();\r\n      return prev;\r\n    }\r\n\r\n    if(elsToRemove.length) {\r\n      const next = prev.filter((e) => !elsToRemove.includes(e));\r\n      elsToRemove.length = 0;\r\n      onChange({list: next, added: [], removed: [], unchanged: next, finishRemoved});\r\n      return next;\r\n    }\r\n\r\n    return untrack(() => {\r\n      const nextSet: ReadonlySet<T> = new Set(sourceList);\r\n      const next: T[] = sourceList.slice();\r\n\r\n      const added: T[] = [];\r\n      const removed: T[] = [];\r\n      const unchanged: T[] = [];\r\n\r\n      for(const el of sourceList) {\r\n        (prevSet.has(el) ? unchanged : added).push(el);\r\n      }\r\n\r\n      const removedOptions: Modify<RemovedOptions, {element?: T, previousIndex?: number}> = {\r\n        elements: next,\r\n        previousElements: prev,\r\n        side: 'start'\r\n      };\r\n\r\n      let nothingChanged = !added.length;\r\n      for(let i = 0; i < prev.length; ++i) {\r\n        const el = prev[i]!;\r\n        if(!nextSet.has(el)) {\r\n          if(!exiting.has(el)) {\r\n            removed.push(el);\r\n            exiting.add(el);\r\n          }\r\n\r\n          removedOptions.element = el;\r\n          removedOptions.previousIndex = i;\r\n\r\n          handleRemoved(removedOptions as RemovedOptions);\r\n        } else {\r\n          removedOptions.side = 'end';\r\n        }\r\n\r\n        if(nothingChanged && el !== next[i]) {\r\n          nothingChanged = false;\r\n        }\r\n      }\r\n\r\n      // skip if nothing changed\r\n      if(!removed.length && nothingChanged) {\r\n        return prev;\r\n      }\r\n\r\n      onChange({list: next, added, removed, unchanged, finishRemoved});\r\n\r\n      prevSet = nextSet;\r\n      return next;\r\n    });\r\n  };\r\n\r\n  return createMemo(compute, options.appear ? [] : initSource.slice());\r\n}\r\n","import {JSX} from 'solid-js';\r\nimport {createListTransition} from './createListTransition';\r\nimport {resolveElements} from '@solid-primitives/refs';\r\nimport liteMode from '../liteMode';\r\n\r\nfunction wrapKeyframes(keyframes: Keyframe[] | ((element: Element, removed: boolean) => Keyframe[])) {\r\n  return typeof(keyframes) !== 'function' ? () => keyframes : keyframes;\r\n}\r\n\r\nexport function AnimationList(props: {\r\n  children: JSX.Element\r\n  animationOptions: KeyframeAnimationOptions,\r\n  keyframes: Keyframe[] | ((element: Element, removed: boolean) => Keyframe[]),\r\n  mode: 'replacement' | 'add-remove'/*  | 'add' */ | 'remove',\r\n  itemClassName?: string,\r\n  appear?: boolean\r\n}) {\r\n  const children = resolveElements(() => props.children).toArray;\r\n\r\n  const addClassName = props.itemClassName ? (added: Element[]) => {\r\n    added.forEach((element) => {\r\n      element.classList.add(props.itemClassName);\r\n    });\r\n  } : undefined;\r\n\r\n  addClassName?.(children());\r\n\r\n  const transitionList = createListTransition(children, {\r\n    exitMethod: 'keep-index',\r\n    appear: props.appear,\r\n    onChange: ({added, removed, finishRemoved}) => {\r\n      const options = props.animationOptions;\r\n      if(!liteMode.isAvailable('animations')) {\r\n        options.duration = 0;\r\n      }\r\n\r\n      addClassName?.(added);\r\n\r\n      const getKeyframes = wrapKeyframes(props.keyframes);\r\n      let shouldAnimateAdded = false, shouldAnimateRemoved = false;\r\n      if(props.mode === 'replacement') {\r\n        shouldAnimateAdded = !!removed.length;\r\n        shouldAnimateRemoved = !!added.length;\r\n      } else if(props.mode === 'remove') {\r\n        shouldAnimateRemoved = !!removed.length;\r\n      } else if(props.mode === 'add-remove') {\r\n        shouldAnimateAdded = !!added.length;\r\n        shouldAnimateRemoved = !!removed.length;\r\n      }\r\n\r\n      queueMicrotask(() => {\r\n        if(shouldAnimateAdded) {\r\n          const keyframes = added.map((element) => getKeyframes(element, false));\r\n          added.forEach((element, idx) => {\r\n            element.animate(keyframes[idx], options);\r\n          });\r\n        }\r\n\r\n        if(!shouldAnimateRemoved) {\r\n          finishRemoved(removed);\r\n          return;\r\n        }\r\n\r\n        const reversedKeyframes = removed.map((element) => getKeyframes(element, true).slice().reverse());\r\n        const promises: Promise<any>[] = [];\r\n        removed.forEach((element, idx) => {\r\n          const animation = element.animate(reversedKeyframes[idx], options);\r\n          promises.push(animation.finished);\r\n        });\r\n\r\n        Promise.all(promises).then(() => finishRemoved(removed));\r\n      });\r\n    }\r\n  }) as unknown as JSX.Element;\r\n\r\n  return transitionList;\r\n}\r\n","import {JSX} from 'solid-js';\r\nimport {Dynamic} from 'solid-js/web';\r\nimport {AnimationList} from './animationList';\r\nimport {getTransition} from '../../config/transitions';\r\n\r\ntype AnimationType = 'cross-fade' | 'grow-width' | 'grow-height';\r\n\r\nconst growKeyframes = (property: 'width' | 'height', size: number): Keyframe[] => {\r\n  return [\r\n    {[property]: 0, opacity: 0},\r\n    // {width: clientWidth / 2 + 'px', opacity: .25},\r\n    {[property]: size + 'px', opacity: 1}\r\n  ];\r\n};\r\n\r\nconst ANIMATIONS: {[key in AnimationType]: Keyframe[] | ((element: Element) => Keyframe[])} = {\r\n  'cross-fade': [{opacity: 0}, {opacity: 1}],\r\n  'grow-width': (element) => growKeyframes('width', element.clientWidth),\r\n  'grow-height': (element) => growKeyframes('height', element.clientHeight)\r\n};\r\n\r\nexport function SimpleAnimation(props: Pick<\r\n  Parameters<typeof AnimationList>[0], 'children' | 'keyframes' | 'mode' | 'appear'\r\n> & {\r\n  noItemClass?: boolean\r\n}) {\r\n  return (\r\n    <AnimationList\r\n      animationOptions={{duration: 200, easing: getTransition('standard').easing}}\r\n      keyframes={props.keyframes}\r\n      mode={props.mode || 'replacement'}\r\n      itemClassName={!props.noItemClass && 'animated-item'}\r\n      appear={props.appear}\r\n    >\r\n      {props.children}\r\n    </AnimationList>\r\n  );\r\n}\r\n\r\n// const MAP = {\r\n//   'cross-fade': ReplacementAnimation\r\n// };\r\n\r\nexport default function Animated(props: {\r\n  children: JSX.Element,\r\n  type: AnimationType,\r\n  mode?: Parameters<typeof AnimationList>[0]['mode'],\r\n  appear?: boolean,\r\n  noItemClass?: boolean\r\n}) {\r\n  return (\r\n    <Dynamic\r\n      component={SimpleAnimation}\r\n      keyframes={ANIMATIONS[props.type]}\r\n      mode={props.mode}\r\n      appear={props.appear}\r\n      noItemClass={props.noItemClass}\r\n    >\r\n      {props.children}\r\n    </Dynamic>\r\n  );\r\n}\r\n","import PopupElement, {createPopup} from './indexTsx'\r\n\r\nimport {CodeInputField} from '../codeInputField';\r\nimport {TransitionSliderTsx} from '../transitionTsx';\r\nimport {createEffect, createSignal, onCleanup, onMount, Ref, Show} from 'solid-js';\r\n\r\nimport styles from './emailSetup.module.scss';\r\nimport LottieAnimation from '../lottieAnimation';\r\nimport lottieLoader from '../../lib/rlottie/lottieLoader';\r\nimport {I18nTsx} from '../../helpers/solid/i18n';\r\nimport {InputFieldTsx} from '../inputFieldTsx';\r\nimport {LangPackKey} from '../../lib/langPack';\r\nimport ButtonTsx from '../buttonTsx';\r\nimport classNames from '../../helpers/string/classNames';\r\nimport {AccountSentEmailCode, EmailVerifyPurpose, MessageEntity} from '../../layer';\r\nimport appNavigationController, {NavigationItem} from '../appNavigationController';\r\nimport InputField, {InputState} from '../inputField';\r\nimport {doubleRaf, fastRaf} from '../../helpers/schedulers';\r\nimport Animated from '../../helpers/solid/animations';\r\nimport rootScope from '../../lib/rootScope';\r\nimport {subscribeOn} from '../../helpers/solid/subscribeOn';\r\nimport wrapRichText from '../../lib/richTextProcessor/wrapRichText';\r\n\r\nexport function wrapEmailPattern(pattern: string) {\r\n  if(pattern.includes(' ') || !pattern.includes('*')) return pattern;\r\n\r\n  const entities: MessageEntity[] = [];\r\n  for(let i = 0; i < pattern.length;) {\r\n    const idx = pattern.indexOf('*', i);\r\n    if(idx === -1) break;\r\n    let endIdx = idx + 1;\r\n    while(pattern[endIdx] === '*') endIdx++;\r\n\r\n    entities.push({\r\n      _: 'messageEntitySpoiler',\r\n      offset: idx,\r\n      length: endIdx - idx\r\n    });\r\n\r\n    i = endIdx;\r\n  }\r\n\r\n  return wrapRichText(pattern, {entities, noTextFormat: true});\r\n}\r\n\r\nexport function EnterEmailStep(props: {\r\n  isInitialSetup?: boolean\r\n  footerClass?: string\r\n  purpose: EmailVerifyPurpose\r\n  onCodeSent: (code: AccountSentEmailCode.accountSentEmailCode) => void\r\n}) {\r\n  const [error, setError] = createSignal<LangPackKey | undefined>(undefined);\r\n  const [email, setEmail] = createSignal<string>('');\r\n  const [loading, setLoading] = createSignal(false);\r\n\r\n  let inputRef!: InputField;\r\n\r\n  function onSubmit() {\r\n    if(!email().includes('@')) {\r\n      inputRef.setError();\r\n      return;\r\n    }\r\n\r\n    setLoading(true);\r\n    rootScope.managers.appAccountManager.sendVerifyEmailCode(\r\n      props.purpose,\r\n      email()\r\n    ).then(() => {\r\n      setLoading(false);\r\n      props.onCodeSent({\r\n        _: 'account.sentEmailCode',\r\n        email_pattern: email(),\r\n        length: 6\r\n      });\r\n    }).catch((err: ApiError) => {\r\n      if(err.type === 'EMAIL_INVALID') {\r\n        setError('EmailSetup.InvalidEmail');\r\n      } else if(err.type === 'EMAIL_NOT_ALLOWED') {\r\n        setError('EmailSetup.BadEmail');\r\n      } else {\r\n        console.error(err);\r\n        setError('Error.AnError');\r\n      }\r\n\r\n      // avoid flashing while transitioning to error state\r\n      setTimeout(() => {\r\n        setLoading(false);\r\n      }, 200);\r\n    });\r\n  }\r\n\r\n  onMount(() => {\r\n    doubleRaf().then(() => {\r\n      inputRef.input.focus();\r\n    })\r\n\r\n    subscribeOn(inputRef.input)('keydown', (e) => {\r\n      if(e.key === 'Enter') {\r\n        e.preventDefault();\r\n        onSubmit();\r\n      }\r\n    });\r\n  });\r\n\r\n  return (\r\n    <div class={styles.page}>\r\n      <LottieAnimation\r\n        class={styles.lottie}\r\n        lottieLoader={lottieLoader}\r\n        name=\"Mailbox\"\r\n        size={120}\r\n        restartOnClick\r\n        rlottieOptions={{\r\n          loop: false,\r\n          autoplay: true\r\n        }}\r\n      />\r\n\r\n      <I18nTsx class={styles.title} key={props.isInitialSetup ? 'EmailSetup.Title' : 'EmailSetup.ChangeTitle'} />\r\n      <I18nTsx class={styles.subtitle} key={props.isInitialSetup ? 'EmailSetup.Subtitle' : 'EmailSetup.ChangeSubtitle'} />\r\n\r\n      <InputFieldTsx\r\n        instanceRef={ref => inputRef = ref}\r\n        class={styles.input}\r\n        label=\"EmailSetup.InputCaption\"\r\n        disabled={loading()}\r\n        value={email()}\r\n        errorLabel={error() ? null : undefined}\r\n        onRawInput={(val) => {\r\n          setEmail(val);\r\n          setError(undefined);\r\n          inputRef.setState(InputState.Neutral);\r\n        }}\r\n      />\r\n\r\n      <div class={classNames(styles.footer, props.footerClass)}>\r\n        <Animated type=\"cross-fade\">\r\n          <Show\r\n            when={!error()}\r\n            fallback={(\r\n              <div class={styles.error}>\r\n                <I18nTsx key={error()} />\r\n              </div>\r\n            )}\r\n          >\r\n            <div class={styles.buttonContainer}>\r\n              <ButtonTsx\r\n                class={classNames(styles.button, 'btn-primary btn-color-primary')}\r\n                text=\"Continue\"\r\n                disabled={loading()}\r\n                onClick={onSubmit}\r\n              />\r\n            </div>\r\n          </Show>\r\n        </Animated>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport function EnterCodeStep(props: {\r\n  footerClass?: string\r\n  visible?: boolean\r\n  purpose: EmailVerifyPurpose\r\n  sentCode: AccountSentEmailCode.accountSentEmailCode\r\n  onSuccess: () => void\r\n  onExpired: () => void\r\n}) {\r\n  const [error, setError] = createSignal<LangPackKey | undefined>(undefined);\r\n  const [loading, setLoading] = createSignal(false);\r\n  const codeSignal = createSignal<string>('');\r\n\r\n  let inputRef!: HTMLInputElement;\r\n\r\n  createEffect(() => {\r\n    if(props.visible !== false) {\r\n      doubleRaf().then(() => {\r\n        inputRef.focus();\r\n      })\r\n    }\r\n  })\r\n\r\n  function onSubmit() {\r\n    setLoading(true);\r\n    rootScope.managers.appAccountManager.verifyEmail(\r\n      props.purpose,\r\n      {\r\n        _: 'emailVerificationCode',\r\n        code: codeSignal[0]()\r\n      }\r\n    ).then(() => {\r\n      setLoading(false);\r\n      props.onSuccess();\r\n    }).catch((err: ApiError) => {\r\n      if(err.type === 'EMAIL_VERIFY_EXPIRED') {\r\n        setLoading(false);\r\n        return props.onExpired();\r\n      }\r\n\r\n      if(err.type === 'CODE_INVALID') {\r\n        setError('EmailSetup.WrongCode');\r\n      } else {\r\n        console.error(err);\r\n        setError('Error.AnError');\r\n      }\r\n\r\n      codeSignal[1]('');\r\n\r\n      // avoid flashing while transitioning to error state\r\n      setTimeout(() => {\r\n        setLoading(false);\r\n        fastRaf(() => inputRef.focus());\r\n      }, 200);\r\n    });\r\n  }\r\n\r\n  return (\r\n    <div class={styles.page}>\r\n      <LottieAnimation\r\n        class={styles.lottie}\r\n        lottieLoader={lottieLoader}\r\n        name=\"LoveLetter\"\r\n        size={120}\r\n        restartOnClick\r\n        rlottieOptions={{\r\n          loop: false,\r\n          autoplay: true\r\n        }}\r\n      />\r\n\r\n      <I18nTsx class={styles.title} key=\"EmailSetup.CheckEmail\" />\r\n      <I18nTsx\r\n        class={styles.subtitle}\r\n        key=\"EmailSetup.CheckEmailSubtitle\"\r\n        args={[wrapEmailPattern(props.sentCode.email_pattern)]}\r\n      />\r\n\r\n      <CodeInputField\r\n        ref={inputRef}\r\n        valueSignal={codeSignal}\r\n        class={styles.input}\r\n        length={props.sentCode.length}\r\n        disabled={loading()}\r\n        onFill={onSubmit}\r\n        error={error() != null}\r\n        onChange={() => setError(undefined)}\r\n      />\r\n\r\n      <div class={classNames(styles.footer, props.footerClass)}>\r\n        <Animated type=\"cross-fade\">\r\n          <Show\r\n            when={!error()}\r\n            fallback={(\r\n              <div class={styles.error}>\r\n                <I18nTsx key={error()} />\r\n              </div>\r\n            )}\r\n          >\r\n            <div class={styles.buttonContainer}>\r\n              <ButtonTsx\r\n                class={classNames(styles.button, 'btn-primary btn-color-primary')}\r\n                text=\"Continue\"\r\n                disabled={loading() || codeSignal[0]().length !== props.sentCode.length}\r\n                onClick={onSubmit}\r\n              />\r\n            </div>\r\n          </Show>\r\n        </Animated>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nlet isCurrentlyShowing = false;\r\nexport function showEmailSetupPopup(options: {\r\n  purpose: EmailVerifyPurpose\r\n  noskip: boolean\r\n  onSuccess?: () => void\r\n  onDismiss?: () => void\r\n}) {\r\n  if(isCurrentlyShowing) {\r\n    return;\r\n  }\r\n  isCurrentlyShowing = true;\r\n\r\n  const [show, setShow] = createSignal(false);\r\n  const [page, setPage] = createSignal(0);\r\n  const [code, setCode] = createSignal<AccountSentEmailCode.accountSentEmailCode | undefined>(undefined);\r\n  const [codePageTransitionEnded, setCodePageTransitionEnded] = createSignal(false);\r\n\r\n  return createPopup(() => {\r\n    const secondPageNavigationItem: NavigationItem = {\r\n      type: 'left',\r\n      onPop: () => void setPage(0)\r\n    }\r\n\r\n    onCleanup(() => {\r\n      isCurrentlyShowing = false;\r\n      appNavigationController.removeItem(secondPageNavigationItem);\r\n    });\r\n\r\n    doubleRaf().then(() => setShow(true));\r\n\r\n    let isSuccess = false\r\n\r\n    return (\r\n      <PopupElement\r\n        class={styles.popup}\r\n        containerClass={styles.popupContainer}\r\n        show={show()}\r\n        closable={!options.noskip}\r\n        onClose={() => {\r\n          isCurrentlyShowing = false;\r\n          if(!isSuccess) options.onDismiss?.()\r\n        }}\r\n        isConfirmationNeededOnClose={() => {\r\n          if(options.noskip && !isSuccess) return Promise.reject()\r\n        }}\r\n      >\r\n        <PopupElement.Header class={styles.popupHeader}>\r\n          <Show when={!options.noskip || page() === 1}>\r\n            <PopupElement.CloseButton\r\n              class={styles.popupCloseButton}\r\n              canGoBack={page() !== 0}\r\n              onBackClick={() => void setPage(0)}\r\n            />\r\n          </Show>\r\n        </PopupElement.Header>\r\n        <PopupElement.Body>\r\n          <TransitionSliderTsx\r\n            class={styles.slider}\r\n            type=\"navigation\"\r\n            transitionTime={150}\r\n            animateFirst={false}\r\n            currentPage={page()}\r\n            onTransitionStart={(id) => {\r\n              setCodePageTransitionEnded(false);\r\n              if(id === 0) {\r\n                appNavigationController.removeItem(secondPageNavigationItem);\r\n              } else {\r\n                appNavigationController.pushItem(secondPageNavigationItem);\r\n              }\r\n            }}\r\n            onTransitionEnd={(id) => {\r\n              if(id === 1) {\r\n                setCodePageTransitionEnded(true);\r\n              }\r\n            }}\r\n          >\r\n            <EnterEmailStep\r\n              isInitialSetup={true}\r\n              purpose={options.purpose}\r\n              onCodeSent={code => {\r\n                setCode(code);\r\n                setPage(1);\r\n              }}\r\n            />\r\n            <Show when={code()}>\r\n              <EnterCodeStep\r\n                purpose={options.purpose}\r\n                sentCode={code()!}\r\n                visible={page() === 1 && codePageTransitionEnded()}\r\n                onExpired={() => {\r\n                  setPage(0);\r\n                  setCode(undefined);\r\n                }}\r\n                onSuccess={() => {\r\n                  isSuccess = true\r\n                  options.onSuccess?.();\r\n                  setShow(false);\r\n                }}\r\n              />\r\n            </Show>\r\n          </TransitionSliderTsx>\r\n        </PopupElement.Body>\r\n      </PopupElement>\r\n    );\r\n  })\r\n}\r\n"],"names":["subscribeOn","obj","event","callback","options","onCleanup","CodeInputFieldCompat","constructor","errorSignal","createSignal","disabledSignal","valueSignal","container","createRoot","dispose","_self$","el","_$createComponent","CodeInputField","_$mergeProps","ref","r$","_ref$","input","error","disabled","children","value","cleanup","props","setValue","activeIndexStart","setActiveIndexStart","activeIndexEnd","setActiveIndexEnd","isInserting","setIsInserting","isFocused","isShiftKeyDown","previousSelection","inserting","start","end","syncSelection","originalStart","originalEnd","onSelectionChange","inputType","document","activeElement","inputRef","selectionStart","selectionEnd","maxLength","length","direction","startOffset","endOffset","navigatedBackwards","Math","abs","undefined","setSelectionRange","_el$","_tmpl$","_el$2","firstChild","$$input","e","rawValue","finalValue","oldValue","selectionSize","replace","slice","hasInvalidChars","test","preventDefault","currentTarget","onChange","onFill","$$keyup","key","$$keydown","addEventListener","_$use","_$setAttribute","_$insert","Index","each","Array","from","_","idx","_el$3","_tmpl$2","Transition","Show","when","_el$4","_$effect","_$className","styles","digitContent","_c$","_$memo","_el$5","caret","classNames","digit","active","_p$","_v$","wrap","class","_v$2","_v$3","_$delegateEvents","RippleElement","rest","splitProps","rippleElement","setRippleElement","Dynamic","createRenderEffect","noRipple","ret","ripple","element","rippleSquare","Object","entries","classList","map","Button","setDisabled","createMemo","component","as","primaryFilled","primary","primaryTransparent","large","onlyMobile","onClick","result","Promise","finally","err","tabIndex","icon","IconTsx","iconClass","text","i18n","textArgs","iconAfter","Corner","Icon","PopupContext","createContext","PopupControllerContext","DEFAULT_APPEND_TO","body","appendPopupTo","setAppendPopupTo","onFullScreenChange","getFullScreenElement","addFullScreenListener","PopupElement","shown","setShown","store","setStore","createStore","buttons","setButtons","navigationItem","setNavigationItem","controllerContext","useContext","managers","MANAGERS","middlewareHelper","getMiddleware","lateMiddlewareHelper","withoutOverlay","night","overlayCounter","isDarkOverlayActive","confirmShortcutIsSendShortcut","isConfirmationNeededOnClose","register","kind","registerButton","filter","b","show","destroyed","navItem","type","onPop","resolve","then","destroy","appNavigationController","pushItem","blurActiveElement","isOverlayActive","animationIntersector","checkAnimations2","hide","backByItem","onClose","setHiding","setDestroyed","setTimeout","MarkupTooltip","getInstance","removeItem","indexOfAndSplice","POPUPS","onCloseAfterTimeout","hiding","popupElement","setPopupElement","closable","withConfirm","footer","title","push","createEffect","on","_show","Provider","Portal","mount","$$click","findUpClassName","target","isConnected","containerClass","Header","Title","context","titleContent","_tmpl$3","CloseButton","handleClick","canGoBack","onBackClick","_tmpl$4","fallback","_el$6","ConfirmButton","_el$7","_tmpl$5","Body","_el$8","Footer","_el$9","FooterButton","noDefaultClass","secondary","console","log","danger","iconLeft","iconRight","langKey","langArgs","Buttons","_el$10","_tmpl$6","getPopups","popupConstructor","createPopup","untrack","TransitionSliderTsx","onMount","transitionTo","TransitionSlider","content","currentPage","For","child","tabClass","LottieAnimation","inProps","mergeProps","size","animationPromise","div","restartOnClick","animation","playOrRestart","_$classList","style","setProperty","removeProperty","loadAnimation","needRaf","requestAnimationFrame","lottieLoader","loadAnimationAsAsset","loop","autoplay","width","height","rlottieOptions","name","onPromise","remove","attachClassName","accessor","prev","split","add","attachHotClassName","className","I18nTsx","argsEls","resolveElements","args","it","Node","toArray","I18n","IntlElement","_prev","update","defer","createListTransition","source","initSource","prevSet","exiting","toRemove","setToRemove","isTransitionPending","useTransition","finishRemoved","noop","els","p","handleRemoved","index","elsToRemove","sourceList","$TRACK","next","nextSet","added","removed","unchanged","removedOptions","nothingChanged","i","wrapKeyframes","keyframes","AnimationList","addClassName","liteMode","getKeyframes","shouldAnimateAdded","shouldAnimateRemoved","reversedKeyframes","promises","growKeyframes","property","opacity","ANIMATIONS","clientWidth","clientHeight","SimpleAnimation","animationOptions","duration","easing","getTransition","mode","itemClassName","noItemClass","appear","Animated","wrapEmailPattern","pattern","includes","entities","indexOf","endIdx","offset","wrapRichText","noTextFormat","EnterEmailStep","setError","email","setEmail","loading","setLoading","onSubmit","rootScope","appAccountManager","sendVerifyEmailCode","purpose","onCodeSent","email_pattern","catch","doubleRaf","focus","lottie","isInitialSetup","subtitle","InputFieldTsx","instanceRef","label","errorLabel","onRawInput","val","setState","InputState","Neutral","ButtonTsx","button","buttonContainer","page","footerClass","EnterCodeStep","codeSignal","visible","verifyEmail","code","onSuccess","onExpired","fastRaf","sentCode","_v$4","isCurrentlyShowing","showEmailSetupPopup","setShow","setPage","setCode","codePageTransitionEnded","setCodePageTransitionEnded","secondPageNavigationItem","isSuccess","popup","popupContainer","noskip","onDismiss","reject","popupHeader","popupCloseButton","slider","transitionTime","animateFirst","onTransitionStart","id","onTransitionEnd"],"mappings":"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"}